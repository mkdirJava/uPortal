var cbArray=[];function arrayPop(c,b){var d=b;var a=d.indexOf(c);if(a!=-1){d.splice(a,1)}return d}function today(){var a=function(c){return(c.toString().length>1)?c:"0"+c};var b=new Date();return a(b.getMonth()+1)+"/"+a(b.getDate())+"/"+b.getFullYear()}var jobPostings=function(){var m={urls:{},emailFriend:false,portletId:null};var g;var n=[];var i,r,c;var p=function(){c.getJSON(m.urls.invokeNotificationServiceUrl)};var f=function(){var u=c.getJSON(m.urls.getNotificationsUrl,function(v){g=v.categories;jobList=v.feed;n=v.errors}).done(function(){if(n.length>0){q(n)}h();b();e()}).fail(function(){alert("Unable to retrieve the list of jobs")})};var b=function(){var w=r.uniq(r.pluck(jobList,"source"));var v=[];for(var x=0;x<w.length;x++){v.push(w[x]);v.sort()}w=v;var u=r.template(c("#"+m.portletId+"tmpl_hiringCenters").html(),{offices:w});c("#"+m.portletId+" .hiringCenters").html(u)};var h=function(){var u=r.template(c("#"+m.portletId+"tmpl_categories").html(),{categories:g});c("#"+m.portletId+" .filter-categories").html(u)};var l=function(){i.fnFilterClear();b();h()};var d=function(v){var u=i.fnGetData(v);u.emailFriend=m.emailFriend;t(u)};var k=function(w){var x=c(w).children("i");var y=c.get(w.href,function(){x.toggleClass("fa-star-o fa-star")}).fail(function(){});var u=i.fnGetPosition(w.parentNode);var v=i.fnGetData(u[0]);i.fnUpdate(!v.favorite,u[0],u[1],false)};var t=function(v){var u=r.template(c("#"+m.portletId+"tmpl_jobDescriptionModal").html(),v);c("#"+m.portletId+" .jobDetailsModal").find(".modal-content").html(u);a();c("#"+m.portletId+" .emailFriendButton").on("click",function(w){c("#"+m.portletId+" .modal-overlay").show()});c("#"+m.portletId+" .cancelEmailButton").on("click",function(w){c("#"+m.portletId+" .modal-overlay").hide()});c("#"+m.portletId+" .sendEmailButton").on("click",function(w){c.post("test.php",c("#"+m.portletId+" .emailFriendForm").serialize());c("#"+m.portletId+" .modal-overlay").hide();a()})};var a=function(){c("#"+m.portletId+" .jobDetailsModal").modal("toggle")};var s=function(v,u){i.fnFilter(v,u,true,false)};var q=function(v){var x="";for(var u=0;u<v.length;u++){var w=v[u];x+=w.source+": "+w.error+"<br/>"}c("#errorOutput").show().html(x)};var o=function(){var u=document.getElementById("loading");if(u.parentNode){u.parentNode.removeChild(u)}};var e=function(){c.fn.dataTableExt.oApi.fnGetHiddenNodes=function(w){var y=this.oApi._fnGetTrNodes(w);var x=c("tbody tr",w.nTable);for(var u=0;u<x.length;u++){var v=jQuery.inArray(x[u],y);if(v!=-1){y.splice(v,1)}}return y};c.fn.dataTableExt.afnFiltering.push(function(A,x,w){var y=document.getElementById(m.portletId+"date-range").value;if(y===""){return true}y=Date.parse(y);var v=3;var u=3;var z=Date.parse(x[v]);if(z>=y){return true}return false});c.extend(true,c.fn.dataTable.defaults,{sDom:"<'row'<'col-md-6 toggleCheckbox'><'col-md-6 text-right'l>t<'row'<'col-md-6'i><'col-md-6'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:"Show _MENU_ entries"}});c.extend(c.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper form-inline"});c.fn.dataTableExt.oApi.fnFilterClear=function(w){w.oPreviousSearch.sSearch="";if(typeof w.aanFeatures.f!="undefined"){var x=w.aanFeatures.f;for(var v=0,u=x.length;v<u;v++){c("input",x[v]).val("")}}for(var v=0,u=w.aoPreSearchCols.length;v<u;v++){w.aoPreSearchCols[v].sSearch=""}w.oApi._fnReDraw(w)};c.fn.dataTableExt.oApi.fnPagingInfo=function(u){return{iStart:u._iDisplayStart,iEnd:u.fnDisplayEnd(),iLength:u._iDisplayLength,iTotal:u.fnRecordsTotal(),iFilteredTotal:u.fnRecordsDisplay(),iPage:u._iDisplayLength===-1?0:Math.ceil(u._iDisplayStart/u._iDisplayLength),iTotalPages:u._iDisplayLength===-1?0:Math.ceil(u.fnRecordsDisplay()/u._iDisplayLength)}};c.extend(c.fn.dataTableExt.oPagination,{bootstrap:{fnInit:function(y,v,x){var u=y.oLanguage.oPaginate;var z=function(A){A.preventDefault();if(y.oApi._fnPageChange(y,A.data.action)){x(y)}};c(v).append('<ul class="pagination"><li class="prev disabled"><a href="#"><i class="fa fa-caret-left"></i> '+u.sPrevious+'</a></li><li class="next disabled"><a href="#">'+u.sNext+" </a></li></ul>");var w=c("a",v);c(w[0]).bind("click.DT",{action:"previous"},z);c(w[1]).bind("click.DT",{action:"next"},z)},fnUpdate:function(w,C){var D=5;var y=w.oInstance.fnPagingInfo();var B=w.aanFeatures.p;var A,E,z,x,u,F,v=Math.floor(D/2);if(y.iTotalPages<D){u=1;F=y.iTotalPages}else{if(y.iPage<=v){u=1;F=D}else{if(y.iPage>=(y.iTotalPages-v)){u=y.iTotalPages-D+1;F=y.iTotalPages}else{u=y.iPage-v+1;F=u+D-1}}}for(A=0,E=B.length;A<E;A++){c("li:gt(0)",B[A]).filter(":not(:last)").remove();for(z=u;z<=F;z++){x=(z==y.iPage+1)?'class="active"':"";c("<li "+x+'><a href="#">'+z+"</a></li>").insertBefore(c("li:last",B[A])[0]).bind("click",function(G){G.preventDefault();w._iDisplayStart=(parseInt(c("a",this).text(),10)-1)*y.iLength;C(w)})}if(y.iPage===0){c("li:first",B[A]).addClass("disabled")}else{c("li:first",B[A]).removeClass("disabled")}if(y.iPage===y.iTotalPages-1||y.iTotalPages===0){c("li:last",B[A]).addClass("disabled")}else{c("li:last",B[A]).removeClass("disabled")}}}}});if(c.fn.DataTable.TableTools){c.extend(true,c.fn.DataTable.TableTools.classes,{container:"DTTT btn-group",buttons:{normal:"btn",disabled:"disabled"},collection:{container:"DTTT_dropdown dropdown-menu",buttons:{normal:"",disabled:"disabled"}},print:{info:"DTTT_print_info modal"},select:{row:"active"}});c.extend(true,c.fn.DataTable.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}})}c("#"+m.portletId+"jobPostings").dataTable({aaData:jobList,aaSorting:[[3,"desc"]],aoColumnDefs:[{bSortable:false,aTargets:[0,1]},{aTargets:[0],sWidth:"10%",mData:"attributes.status",mRender:function(w,v,u){if(w[0].toLowerCase()==="open"){return'<a href="'+u.url+'" target="_blank" class="btn btn-sm btn-success">Apply</a>'}else{return"Apply in Person"}},fnCreatedCell:function(v,u,y,x,w){if(y.attributes.status!=="open"){c(v).addClass("small-text")}}},{aTargets:[1],sWidth:"5%",mData:"favorite",sClass:"favorite hidden-xs",mRender:function(y,x,w){var u,z;if(w.attributes.status[0].toLowerCase()==="open"){var v=m.urls.invokeActionUrlTemplate.replace(/NOTIFICATIONID/,w.id).replace(/ACTIONID/,"FavoriteAction");if(y===true){return'<span class="sr-only">'+y+'</span><a href="'+v+'" title="Remove from saved jobs"><i class="fa fa-star"></i></a>'}else{return'<span class="sr-only">'+y+'</span><a href="'+v+'" title="Add to saved jobs"><i class="fa fa-star-o"></i></a>'}}else{return""}}},{aTargets:[2],sWidth:"30%",mData:"title",sClass:"jobTitle",mRender:function(w,v,u){return'<a href="'+u.id+'" title="'+u.linkText+'" class="jobDetailsLink" >'+w+"</a>"}},{aTargets:[3],sWidth:"10%",sClass:"hidden-xs",mData:"attributes.postDate",mRender:function(w,v,u){return w[0]}},{aTargets:[4],sWidth:"15%",mData:"id",sClass:"hidden-xs hidden-sm",mRender:function(w,v,u){return w}},{aTargets:[5],mData:"attributes.department",sClass:"hidden-xs"},{aTargets:[6],mData:"attributes.category",bVisible:false},{aTargets:[7],mData:"source",bVisible:false},{aTargets:[8],mData:"attributes.description",bVisible:false},{aTargets:[9],mData:"attributes.qualifications",bVisible:false}],fnInitComplete:function(v,u){i=this;c(".searchControls :checkbox").change(function(z){var y;if(c(this).is(":checked")){cbArray.push(this.value)}else{arrayPop(this.value,cbArray)}y=cbArray.join("|");s(y,6)});c(".toggleCheckbox").on("change","#inPersonCb",function(){var y;if(c("#inPersonCb").is(":checked")){y=""}else{y="^(?:(?!person).)*$\r?\n?"}s(y,0)});c("#navSaved").click(function(){s("true",1)});c("#navSearch").click(function(){s("",1)});c("#"+m.portletId+"searchTerms").keyup(function(y){s(this.value,null)});c("#"+m.portletId+"date-range").change(function(){i.fnDraw()});c("#"+m.portletId+"hiringCenters").change(function(){s(this.value,7)});c("#"+m.portletId+"jobPostings").delegate("td.favorite a","click",function(y){y.preventDefault();k(this)});c("#"+m.portletId+"jobPostings").delegate("td.jobTitle a","click",function(y){y.preventDefault();d(c(this).closest("tr")[0])});c(".primary-nav").click(function(y){y.preventDefault();c(".primary-nav").children().removeClass("active");c(y.target).parent().addClass("active")});var x=c("<label>");var w=c("<input>",{type:"checkbox",id:"inPersonCb",checked:true});c(".toggleCheckbox").append(x.html(w).append('Show "apply in person" jobs'));o()}})};(function j(){})();return{init:function(u,v,w,x){r=v;c=u;m.portletId=x;if(w){m.urls=w;p();f()}},clearFilter:function(){l()},getTable:function(){return i}}}();