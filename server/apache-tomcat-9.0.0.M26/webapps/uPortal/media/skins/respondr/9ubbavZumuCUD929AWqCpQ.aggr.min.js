"use strict";var up=up||{};(function(b,a){up.defaultNodeIdExtractor=function(c){return b(c).attr("id").split("_")[1];};up.getStringPropertySortFunction=function(c,d){return function(f,e){var h=f[c].toLowerCase();var g=e[c].toLowerCase();if(h===g){return 0;}if(d){d=d.toLowerCase();if(h===d){return -1;}else{if(g===d){return 1;}}}if(h>g){return 1;}else{return -1;}};};up.escapeSpecialChars=function(d){var c=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");return d.replace(c,"\\$&");};up.refreshPager=function(c,e){var d=a.copy(c.model);d.totalRange=e.length;d.pageIndex=0;d.pageCount=Math.max(1,Math.floor((d.totalRange-1)/d.pageSize)+1);a.clear(c.options.dataModel);a.model.copyModel(c.options.dataModel,e);c.permutation=undefined;c.events.onModelChange.fire(d,c.model,c);a.model.copyModel(c.model,d);};up.showLoader=function(c){c.show();};up.hideLoader=function(c,f){var d,e;e=(f===undefined)?1000:f;d=setTimeout(function(){c.fadeOut("slow");clearTimeout(d);},e);};up.formatMessage=function(g,c){var f=g;for(var d=0;d<c.length;d++){var e=new RegExp("\\{"+d+"\\}","gm");f=f.replace(e,c[d]);}return f;};})(jQuery,fluid);
"use strict";var up=up||{};(function(d,a){var c=function(g){return{id:g.id,description:g.description,fname:g.fname,title:g.title,name:g.name,state:g.state,type:g.typeId,iconUrl:g.iconUrl};};var b=function(g){return{id:g.id,name:g.name,description:g.description,categories:[],deepCategories:[],portlets:[],deepPortlets:[]};};var f=function(h,g){if(!h.state.categories[g.id]){var i=new b(g);d(g.categories).each(function(j,k){k=f(h,k);i.categories.push(k);i.categories[k.id]=i.categories[i.categories.length-1];if(!i.deepCategories[k.id]){i.deepCategories.push(k);i.deepCategories[k.id]=i.deepCategories[i.deepCategories.length-1];}d(k.deepCategories).each(function(l,m){if(!i.deepCategories[m.id]){i.deepCategories.push(m);i.deepCategories[m.id]=i.deepCategories[i.deepCategories.length-1];}});d(k.deepPortlets).each(function(l,m){if(!i.deepPortlets["portlet."+m.id]){i.deepPortlets.push(m);i.deepPortlets["portlet."+m.id]=i.deepPortlets[i.deepPortlets.length-1];}});});d(g.channels).each(function(j,k){var l=new c(k);i.portlets.push(l);i.portlets["portlet."+l.id]=i.portlets[i.portlets.length-1];if(!h.state.portlets["portlet."+l.id]){h.state.portlets.push(l);h.state.portlets["portlet."+l.id]=h.state.portlets[h.state.portlets.length-1];}if(!i.deepPortlets["portlet."+l.id]){i.deepPortlets.push(l);i.deepPortlets["portlet."+l.id]=h.state.portlets[i.deepPortlets.length-1];}});h.state.categories.push(i);h.state.categories[i.id]=h.state.categories[h.state.categories.length-1];return i;}else{return h.state.categories[g.id];}};var e=function(g){d.ajax({url:g.options.portletListUrl,success:function(h){g.state=g.state||{};g.state.portlets=[];g.state.categories=[];d(h.registry.categories).each(function(i,j){f(g,j);});if(h.registry.channels.length>0){f(g,{id:"uncat",name:"Uncategorized",description:"Uncategorized Channels",categories:[],channels:h.registry.channels});}g.events.onLoad.fire();},dataType:"json"});};up.PortletRegistry=function(g,h){var i=a.initView("up.PortletRegistry",g,h);i.refreshRegistry=function(){e(i);};i.getPortlet=function(j){return i.state.portlets["portlet."+j];};i.getCategory=function(j){return i.state.categories[j];};i.getMemberPortlets=function(j,k){return k?i.state.categories[j].deepPortlets:i.state.categories[j].portlets;};i.getMemberCategories=function(j,k){return k?i.state.categories[j].deepCategories:i.state.categories[j].categories;};i.getAllCategories=function(){return i.state.categories;};i.getAllPortlets=function(){return i.state.portlets;};e(i);return i;};a.defaults("up.PortletRegistry",{portletListUrl:null,allCategoriesName:"All",events:{onLoad:null},listeners:{onLoad:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.EntityRegistry=function(c,d){var e=a.initView("up.EntityRegistry",c,d);e.state=e.state||{};e.state.entityCache=new Array();e.searchEntities=function(i,f){var g,h;g=e.options.entitiesUrl+".json";b.ajax({async:false,url:g,type:"GET",dataType:"json",data:{entityType:i,q:f},success:function(j){h=j.jsonEntityBeanList;}});return h;};e.getEntity=function(j,i){var f,h,g;f=j+":"+i;if(e.state.entityCache[f]){g=e.state.entityCache[f];}h=e.options.entitiesUrl+"/"+j+"/"+i+".json";b.ajax({async:false,url:h,type:"GET",dataType:"json",success:function(k){e.state.entityCache[f]=k.jsonEntityBean;g=k.jsonEntityBean;}});return g;};e.removeEntity=function(f){if(e.state.entityCache[f]){delete e.state.entityCache[f];}};return e;};a.defaults("up.EntityRegistry",{entitiesUrl:"/uPortal/api/entities"});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){up.DefaultPortletSearchView=function(e,i,g){var h,f,d;h=b.initView("up.DefaultPortletSearchView",e,g);h.state={};f=[{id:"searchForm",selector:h.options.selectors.searchForm},{id:"searchInput",selector:h.options.selectors.searchInput}];d={children:[{ID:"searchForm",decorators:[{type:"jQuery",func:"submit",args:function(){i.events.onPortletSearch.fire(i,h.locate("searchInput").val(),true);return false;}}]},{ID:"searchInput",value:h.options.searchInvitationMessage,decorators:[{type:"jQuery",func:"keyup",args:function(){i.events.onPortletSearch.fire(i,c(this).val(),false);c(".pager-button-up-inner").click();}},{type:"jQuery",func:"focus",args:function(){if(c(this).val()===h.options.searchInvitationMessage){c(this).val("");}}},{type:"jQuery",func:"blur",args:function(){var j;j=c.trim(c(this).val());if(j===""){c(this).val(h.options.searchInvitationMessage);}}}]}]};h.state.templates=b.selfRender(h.locate("portletSearchView"),d,{cutpoints:f});return h;};b.defaults("up.DefaultPortletSearchView",{searchInvitationMessage:"Search for stuff",selectors:{portletSearchView:".portlet-search-view",searchForm:".portlet-search-form",searchInput:".portlet-search-input"}});up.PortletBrowser=function(d,g,e){var f=b.initView("up.PortletBrowser",d,e);f.options.portletRegistry.options=f.options.portletRegistry.options||{};f.options.portletRegistry.options.listeners=f.options.portletRegistry.options.listeners||{};f.options.portletRegistry.options.listeners.onLoad=function(){a(f,g,d);};f.registry=b.initSubcomponent(f,"portletRegistry",[d,b.COMPONENT_OPTIONS]);return f;};var a=function(e,f,d){e.state={};e.categoryListView=b.initSubcomponent(e,"categoryListView",[d,e,b.COMPONENT_OPTIONS]);if(e.options.stateListView!=null){e.stateListView=b.initSubcomponent(e,"stateListView",[d,e,b.COMPONENT_OPTIONS]);}e.searchView=b.initSubcomponent(e,"searchView",[d,e,b.COMPONENT_OPTIONS]);e.portletListView=b.initSubcomponent(e,"portletListView",[d,e,b.COMPONENT_OPTIONS]);e.events.onLoad.fire(e,f);};b.defaults("up.PortletBrowser",{portletRegistry:{type:"up.PortletRegistry"},searchView:{type:"up.DefaultPortletSearchView"},events:{onLoad:null,onCategorySelect:null,onStateSelect:null,onPortletSearch:null,onPortletSelect:null,onPortletDrag:null},listeners:{onLoad:null,onCategorySelect:function(e,d){e.state.currentCategory=d.id;e.categoryListView.refresh();e.portletListView.refresh();},onStateSelect:function(d,e){d.state.currentState=e;d.portletListView.refresh();},onPortletSearch:function(f,e,d){e=c.trim(e);f.state.portletRegex=e.length>0?new RegExp(up.escapeSpecialChars(e),"i"):undefined;f.portletListView.refresh();},onPortletSelect:function(d,e){d.portletListView.refresh();},onPortletDrag:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(e,c){var d=function(i,h){var j;if(i.find(h).length>0){j=true;}else{j=false;}return j;};var b=function(l,n){var k,h,i,m,j,o;k=e(n);h=k.find(l.options.selectors.portlet);o=e(l.elem.pseudoDropTargetMarkUp);if(h.length>0){i=k.find(l.options.selectors.lastPortletLocked);if(i.length>0){o.insertAfter(i);}else{m=k.find(l.options.selectors.portletMovable).first();o.insertBefore(m);}}else{j=k.children();if(j.length>0){o.insertAfter(j.get((j.length-1)));}else{k.prepend(o);}}o.show();};var g=function(i,j){var h,k;h=e(j);k=h.find(i.options.selectors.pseudoDropTarget);k.remove();};var f=function(l,m){var o,k,q,n,i,p,j,h;o=l.elem.loader;k=e(m);i=k.find(l.options.selectors.pseudoDropTarget);o.css({margin:"7px 0 0 0",opacity:".70","background-color":"#000"});up.showLoader(o);i.addClass(l.options.styles.targetDropped);q=d(k,l.options.selectors.portlet);if(q){n=d(k,l.options.selectors.portletMovable);if(n){p=i.prev(l.options.selectors.portlet+":first");if(p.length>0){j=up.defaultNodeIdExtractor(p[0]);h=l.options.appendAfter;}else{p=i.next(l.options.selectors.portlet+":first");j=up.defaultNodeIdExtractor(p[0]);h=l.options.insertBefore;}}else{j=up.defaultNodeIdExtractor(m);h=l.options.appendAfter;}}else{j=up.defaultNodeIdExtractor(m);h=l.options.appendAfter;}l.events.onDropTarget.fire(h,j);};var a=function(h){h.elem={};h.elem.columnContainer=e(h.options.selectors.body).find(h.options.selectors.columnContainer);h.elem.pseudoDropTargetMarkUp='<div class="'+h.options.styles.pseudoDropTarget+'"><span>'+h.options.pseudoDropTargetLabel+"</span></div>";h.elem.loader=e(h.options.selectors.loader);};up.LayoutDraggableManager=function(h,i){var j;j=c.initView("up.LayoutDraggableManager",h,i);j.enableEligibleColumns=function(m,n){var k,l;k=j.elem.columnContainer.find(j.options.selectors.canAddChildren);l=k.find(j.options.selectors.innerColumn);j.makeDroppable(l);};j.makeDroppable=function(k){k.droppable({accept:j.options.selectors.accept,over:function(l,m){b(j,l.target);},out:function(l,m){g(j,l.target);},drop:function(l,m){f(j,l.target);}});};j.makeDraggable=function(l){var k;k=l.find(j.options.selectors.dragHandle);if(e.browser.mozilla){e(j.options.selectors.body).css({position:"relative"});}l.draggable({handle:k,appendTo:j.options.selectors.body,iframeFix:j.options.iframeFix,opacity:j.options.opacity,helper:j.options.helper,revert:j.options.revert,cursor:j.options.cursor,cursorAt:j.options.cursorAt,stack:j.options.stack,zIndex:99999,containment:j.options.selectors.body,start:function(m,n){j.enableEligibleColumns(m,n);}});};j.initDragAndDrop=function(m,o,l){var k,n;k=l.container.find(j.options.selectors.galleryList);if(k.attr("id")!==j.options.useContentPortletListID){n=k.find("li");j.makeDraggable(n);}};a(j);return j;};c.defaults("up.LayoutDraggableManager",{selectors:{body:"body",galleryList:".portlet-list",columnContainer:"#portalPageBodyColumns",column:".portal-page-column",innerColumn:".portal-page-column-inner",dragHandle:".portlet-thumb-gripper",pseudoDropTarget:".layout-draggable-drop-target",loader:"#galleryLoader",accept:".portlet",canAddChildren:".canAddChildren,.up-fragment-admin",portlet:"[id*=portlet_]",lastPortletLocked:"[id*=portlet_].locked:not(.up-fragment-admin):last",portletMovable:"[id*=portlet_].movable,[id*=portlet_].up-fragment-admin"},styles:{pseudoDropTarget:"layout-draggable-drop-target",targetDropped:"layout-draggable-target-dropped",canAddChildren:"canAddChildren"},events:{onDropTarget:null},pseudoDropTargetLabel:"Drop Here",iframeFix:true,opacity:".80",helper:"clone",revert:"invalid",cursor:"move",cursorAt:{top:8,left:10},stack:".portlet .ui-draggable",tolerance:"intersect",insertBefore:"insertBefore",appendAfter:"appendAfter",nbsp:"&nbsp;",useContentPortletListID:"useContentPortletList"});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.AjaxLayoutCategoryListView=function(c,g,e){var f=a.initView("up.AjaxLayoutCategoryListView",c,e);f.state={};var d=[{id:"~categoryContainer:",selector:".category-choice-container"},{id:"category",selector:".category-choice"},{id:"categoryLink",selector:".category-choice-link"},{id:"categoryName",selector:".category-choice-name"}];f.refresh=function(){var i=[];i.push({id:"",name:f.options.rootCategoryName,description:f.options.rootCategoryDescription,categories:[],deepCategories:[],portlets:[],deepPortlets:[]});b(g.registry.getAllCategories()).each(function(k,l){if(l.deepPortlets.length>0&&l.id!=="local.1"){i.push(l);}});i.sort(up.getStringPropertySortFunction("name",f.options.rootCategoryName));var h={children:[]};var j=g.state.currentCategory||"";b(i).each(function(k,l){h.children.push({ID:"categoryContainer:",children:[{ID:"category",decorators:[{type:"addClass",classes:l.id===j?"active":""}]},{ID:"categoryLink",decorators:[{type:"jQuery",func:"click",args:function(){g.events.onCategorySelect.fire(g,l);b(".pager-button-up-inner").click();}}]},{ID:"categoryName",value:l.name}]});});if(f.state.templates){a.reRender(f.state.templates,b(c).find(".categories"),h,{cutpoints:d});}else{f.state.templates=a.selfRender(b(c).find(".categories"),h,{cutpoints:d});}};f.refresh();return f;};a.defaults("up.AjaxLayoutCategoryListView",{rootCategoryName:"ALL",rootCategoryDescription:"All Categories"});up.AjaxLayoutPortletListView=function(c,g,e){var f,d;f=a.initView("up.AjaxLayoutPortletListView",c,e);f.dragManager=a.initSubcomponent(f,"dragManager",[f.container,a.COMPONENT_OPTIONS]);f.dragManager.events.onDropTarget.addListener(function(i,h){f.state.drag.overall.events.onPortletDrag.fire(f.state.drag.data,i,h);});f.state={};d=[{id:"portlet:",selector:".portlet"},{id:"portletWrapper",selector:".portlet-wrapper"},{id:"portletLink",selector:".portlet-thumb-link"},{id:"portletTitle",selector:".portlet-thumb-titlebar"},{id:"portletDescription",selector:".portlet-thumb-description"},{id:"portletIcon",selector:".portlet-thumb-icon"}];f.refresh=function(){var i,h;i=[];h=(g.state.currentCategory&&g.state.currentCategory!=="")?g.registry.getMemberPortlets(g.state.currentCategory,true):g.registry.getAllPortlets();b(h).each(function(l,m){if(!g.state.portletRegex||g.state.portletRegex.test(m.title)||g.state.portletRegex.test(m.name)||g.state.portletRegex.test(m.fname)||g.state.portletRegex.test(m.description)){if(!m.iconUrl){m.iconUrl=f.options.defaultIconUrl;}i.push(m);}});i.sort(up.getStringPropertySortFunction("title"));if(f.state.pager){up.refreshPager(f.state.pager,i);}else{var k=[{key:"portletWrapper",valuebinding:"*.id",components:function(l){return{decorators:[{type:"jQuery",func:"mousedown",args:function(){f.state.drag={overall:g,data:l};}},{type:"attrs",attributes:{title:l.title+" ("+l.name+")"}}]};}},{key:"portletLink",valuebinding:"*.id",components:function(l){return{decorators:[{type:"jQuery",func:"click",args:function(){g.events.onPortletSelect.fire(g,l);}}]};}},{key:"portletTitle",valuebinding:"*.title"},{key:"portletDescription",valuebinding:"*.description"},{key:"portletIcon",valuebinding:"*.id",components:function(l){return{decorators:[{type:"attrs",attributes:{style:"background: url("+l.iconUrl+") top left no-repeat;"}}]};}}];var j={dataModel:i,annotateColumnRange:"portletTitle",columnDefs:k,components:{bodyRenderer:{type:"fluid.table.selfRender",options:{selectors:{root:".portlet-list"},row:"portlet:",rendererOptions:{cutpoints:d}}},pagerBar:{type:"fluid.pager.pagerBar",options:{pageList:{type:"fluid.pager.renderedPageList",options:{linkBody:"a"}}}}},listeners:{onModelChange:function(m,o,l){var n=setTimeout(function(){f.dragManager.initDragAndDrop(m,o,l);clearTimeout(n);},0);}}};f.state.pager=a.pagedTable(b(c).find(".portlet-results"),j);f.state.pager.events.initiatePageSizeChange.fire(f.options.pageSize);}};f.refresh();return f;};a.defaults("up.AjaxLayoutPortletListView",{dragManager:{type:"up.LayoutDraggableManager"},selectors:{galleryList:".portlet-list"},pageSize:6,defaultIconUrl:"/ResourceServingWebapp/rs/tango/0.8.90/32x32/categories/applications-other.png"});up.BrowseContentPane=function(c,f,d){var e=a.initView("up.BrowseContentPane",c,d);var g=false;e.showPane=function(){if(!g){f.showLoading();g=true;e.portletBrowser=a.initSubcomponent(e,"portletBrowser",[e.locate("pane"),f,a.COMPONENT_OPTIONS]);}e.locate("pane").show();e.locate("paneLink").addClass("active");e.events.onShow.fire(e);};e.hidePane=function(){e.locate("pane").hide();e.locate("paneLink").removeClass("active");};e.hidePaneLink=function(){e.locate("pane").hide();e.locate("paneLink").hide().removeClass("active");};e.showPaneLink=function(){e.locate("paneLink").show();};e.showLoading=function(){e.locate("ui").hide();e.locate("loading").show();};e.hideLoading=function(){e.locate("loading").hide();e.locate("ui").show();};e.showPortletList=function(){e.locate("portletList").show();e.locate("fragmentList").hide();e.locate("fragmentMenuDetail").slideUp(300,function(){e.locate("portletMenu").addClass("active");e.locate("fragmentMenu").removeClass("active");e.locate("portletMenuDetail").slideDown(300);});};e.showFragmentList=function(){e.locate("portletList").hide();e.locate("fragmentList").show();e.locate("portletMenuDetail").slideUp(300,function(){e.locate("portletMenu").removeClass("active");e.locate("fragmentMenu").addClass("active");e.locate("fragmentMenuDetail").slideDown(300);});if(!e.fragmentBrowser){e.showLoading();e.fragmentBrowser=a.initSubcomponent(e,"fragmentBrowser",[e.locate("pane"),a.COMPONENT_OPTIONS]);e.hideLoading();}};e.locate("paneLink").click(function(){f.showPane(e.options.key);});e.locate("portletListLink").click(e.showPortletList);e.locate("fragmentListLink").click(e.showFragmentList);return e;};a.defaults("up.BrowseContentPane",{portletBrowser:{type:"up.PortletBrowser",options:{portletRegistry:{options:{portletListUrl:"channel-list.js"}},categoryListView:{type:"up.AjaxLayoutCategoryListView"},portletListView:{type:"up.AjaxLayoutPortletListView"},listeners:{onLoad:function(d,c){c.hideLoading();}}}},fragmentBrowser:{type:"up.FragmentBrowser",options:{fragmentServiceUrl:"tab-list.js"}},key:"add-content",selectors:{pane:".add-content",paneLink:".add-content-link",ui:".content-results-wrapper",loading:".content-loading",portletMenu:".add-content .categories-column",portletMenuDetail:".add-content .categories-wrapper",portletListLink:".add-content .portlet-list-link",portletList:".add-content .portlet-results",fragmentMenu:".packages-column",fragmentMenuDetail:".packages-wrapper",fragmentListLink:".package-list-link",fragmentList:".package-results"},events:{onInitialize:null,onShow:null},listeners:{onInitialize:null,onShow:null}});up.PortalGalleryPane=function(c,f,d){var e,g;e=a.initView("up.PortalGalleryPane",c,d);g=false;e.showPane=function(){if(!g){f.showLoading();e.events.onInitialize.fire(e);g=true;f.hideLoading();}e.locate("pane").show();e.locate("paneLink").addClass("active");e.events.onShow.fire(e);};e.hidePane=function(){e.locate("pane").hide();e.locate("paneLink").removeClass("active");};e.locate("paneLink").click(function(){f.showPane(e.options.key);});return e;};a.defaults("up.PortalGalleryPane",{key:null,selectors:{pane:null,paneLink:null},events:{onInitialize:null,onShow:null},listeners:{onInitialize:null,onShow:null}});up.PortalGallery=function(c,d){var e=a.initView("up.PortalGallery",c,d);e.panes=[];e.panes.push(a.initSubcomponent(e,"browseContentPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"useContentPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"skinPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"layoutPane",[c,e,a.COMPONENT_OPTIONS]));e.openGallery=function(){e.options.isOpen=true;e.locate("galleryHandle").addClass("handle-arrow-up");e.locate("galleryInner").slideDown(e.options.openSpeed);if(b("#portalPageBodyColumns .portal-page-column").filter(".canAddChildren,.up-fragment-admin")){e.showPane("add-content");}else{e.showPane("use-content");e.hidePaneLink("add-content");}};e.closeGallery=function(){e.options.isOpen=false;e.locate("galleryHandle").removeClass("handle-arrow-up");e.locate("galleryInner").slideUp(e.options.closeSpeed);};e.showPane=function(f){b(e.panes).each(function(g,h){if(h.options.key===f){h.showPane();}else{h.hidePane();}});};e.hidePaneLink=function(f){b(e.panes).each(function(g,h){if(h.options.key===f){h.hidePaneLink();}});};e.showPaneLink=function(f){b(e.panes).each(function(g,h){if(h.options.key===f){h.showPaneLink();}});};e.refreshPaneLink=function(f){if(b("#portalPageBodyColumns .portal-page-column").filter(".canAddChildren,.up-fragment-admin")){e.showPaneLink("add-content");}else{e.hidePaneLink("add-content");}};e.showLoading=function(){e.locate("ui").hide();e.locate("loading").show();};e.hideLoading=function(){var g,h,f;g=e.locate("loading");h=e.locate("ui");h.show();g.fadeOut("slow");};e.locate("galleryHandle").click(function(){if(e.options.isOpen){e.closeGallery();}else{e.openGallery();}});e.locate("closeLink").click(e.closeGallery);if(e.options.isOpen){e.openGallery();}return e;};a.defaults("up.PortalGallery",{isOpen:false,openSpeed:500,closeSpeed:50,browseContentPane:{type:"up.BrowseContentPane"},useContentPane:{type:"up.PortalGalleryPane",options:{key:"use-content",selectors:{pane:".use-content",paneLink:".use-content-link"},listeners:{onInitialize:null}}},skinPane:{type:"up.PortalGalleryPane",options:{key:"skin",selectors:{pane:".skins",paneLink:".skin-link"},listeners:{onInitialize:null}}},layoutPane:{type:"up.PortalGalleryPane",options:{key:"layout",selectors:{pane:".layouts",paneLink:".layout-link"},listeners:{onInitialize:function(c){up.LayoutSelector(".layouts-list",{});}}}},selectors:{menu:".menu",galleryInner:".gallery-inner",galleryHandle:".handle span",closeLink:".close-button",loading:".gallery-loader",ui:".content-wrapper .content"}});})(jQuery,fluid);
var up=up||{};(function(e,d){var g=function(j,h){var i=j.locate("permissionsDialog").find("form");i.find("[name=nodeId]").val(j.options.nodeIdExtractor(h));if(h.hasClass(j.options.cssClassNames.movable)){i.find("[name=movable]").attr("checked","checked");}else{i.find("[name=movable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.deletable)){i.find("[name=deletable]").attr("checked","checked");}else{i.find("[name=deletable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.editable)){i.find("[name=editable]").attr("checked","checked");}else{i.find("[name=editable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.addChildAllowed)){i.find("[name=addChildAllowed]").attr("checked","checked");}else{i.find("[name=addChildAllowed]").removeAttr("checked");}var k=j.options.titleExtractor(h);j.locate("formTitle").html(k);};var a=function(j,i){var h=b(j,j.locate("permissionsDialog").find("form")[0]);c(j,i,h);j.locate("permissionsDialog").dialog("close");j.events.onUpdatePermissions.fire(i,h);return false;};var b=function(j,i){var k={};k.elementID=e(i).find("[name=nodeId]").val();k.action="updatePermissions";k.deletable=e(i.deletable).is(":checked");k.movable=e(i.movable).is(":checked");if(i.editable){k.editable=e(i.editable).is(":checked");}if(i.addChildAllowed){k.addChildAllowed=e(i.addChildAllowed).is(":checked");}e.post(j.options.savePermissionsUrl,k,null,"json");var h={deletable:k.deletable,movable:k.movable,editable:k.editable,addChildAllowed:k.addChildAllowed};return h;};var c=function(j,h,i){f(h,i.deletable,j.options.cssClassNames.deletable);f(h,i.movable,j.options.cssClassNames.movable);f(h,i.editable,j.options.cssClassNames.editable);f(h,i.addChildAllowed,j.options.cssClassNames.addChildAllowed);};var f=function(i,h,j){if(h==undefined){return;}if(h){e(i).addClass(j);}else{e(i).removeClass(j);}};up.FragmentPermissionsMenu=function(h,i){var j=d.initView("up.FragmentPermissionsMenu",h,i);j.state={};j.refresh=function(l){var k=j.options.elementExtractor(j,l);g(j,k);j.locate("permissionsForm").unbind("submit").submit(function(){return a(j,k);});return false;};return j;};d.defaults("up.FragmentPermissionsMenu",{savePermissionsUrl:"mvc/layout",elementExtractor:null,titleExtractor:null,nodeIdExtractor:up.defaultNodeIdExtractor,cssClassNames:{movable:"movable",editable:"editable",deletable:"deletable",addChildAllowed:"canAddChildren"},selectors:{formTitle:null},events:{onUpdatePermissions:null},listeners:{onUpdatePermissions:null}});up.FragmentPermissionsManager=function(h,i){var j=d.initView("up.FragmentPermissionsManager",h,i);j.menus={};j.locate("pageDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.pagePermissionsManager=up.FragmentPermissionsMenu(j.locate("pageDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e("#portalNavigationList li.active");},titleExtractor:function(k){return e("#portalNavigationList li.active a.portal-navigation-link").attr("title");},selectors:{formTitle:"h2"}});j.locate("pageDialogLink").click(function(){j.menus.pagePermissionsManager.refresh(e(this));j.locate("pageDialog").dialog("open");});j.locate("columnDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.columnPermissionsManager=up.FragmentPermissionsMenu(j.locate("columnDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e(k).parents(".portal-page-column");},titleExtractor:function(k){return up.formatMessage(j.options.messages.columnX,[e(".portal-page-column").index(k)+1]);},selectors:{formTitle:"h2"}});j.locate("columnDialogLink").click(function(){j.menus.columnPermissionsManager.refresh(e(this));j.locate("columnDialog").dialog("open");});j.locate("portletDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.portletPermissionsManager=up.FragmentPermissionsMenu(j.locate("portletDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e(k).parents(".up-portlet-wrapper");},titleExtractor:function(k){return k.find(".up-portlet-wrapper-inner h2 a:eq(0)").text();},selectors:{formTitle:"h2"},events:{onUpdatePermissions:null},listeners:{onUpdatePermissions:function(l,k){if(!k.movable){l.addClass("locked");}else{l.removeClass("locked");}}}});j.locate("portletDialogLink").click(function(){j.menus.portletPermissionsManager.refresh(e(this));j.locate("portletDialog").dialog("open");});return j;};d.defaults("up.FragmentPermissionsManager",{savePermissionsUrl:"mvc/layout",selectors:{formTitle:null,pageDialog:".edit-page-permissions-dialog",pageDialogLink:"#editPagePermissionsLink",columnDialog:".edit-column-permissions-dialog",columnDialogLink:".portal-column-permissions-link",portletDialog:".edit-portlet-permissions-dialog",portletDialogLink:".portlet-permissions-link"},messages:{columnX:"Column {0}"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){var a=function(d){c.ajax({url:d.options.fragmentServiceUrl,async:false,success:function(e){d.state=d.state||{};d.state.fragments=e.fragments;c(d.state.fragments).each(function(f,g){d.state.fragments[g.owner]=g;});},dataType:"json"});};up.FragmentBrowser=function(d,f){var g=b.initView("up.FragmentBrowser",d,f);var e=[{id:"fragmentContainer:",selector:g.options.selectors.fragmentContainer},{id:"fragment",selector:g.options.selectors.fragment},{id:"fragmentTitle",selector:g.options.selectors.fragmentTitle},{id:"fragmentDescription",selector:g.options.selectors.fragmentDescription},{id:"selectFragmentLink",selector:g.options.selectors.selectFragmentLink}];a(g);g.refresh=function(){if(g.state.pager){g.state.pager.refresh(g.state.fragments);}else{var i=[{key:"fragment",valuebinding:"*.owner",components:function(j){return{decorators:[{type:"addClass",classes:j.subscribed?"fragment-disabled":""}]};}},{key:"fragmentTitle",valuebinding:"*.name"},{key:"fragmentDescription",valuebinding:"*.description"},{key:"selectFragmentLink",valuebinding:"*.owner",components:function(j){return{decorators:[{type:"jQuery",func:"click",args:function(){g.events.onFragmentSelect.fire(g,j);}}]};}}];var h={dataModel:g.state.fragments,annotateColumnRange:"fragmentTitle",columnDefs:i,bodyRenderer:{type:"fluid.pager.selfRender",options:{selectors:{root:g.options.selectors.pagerRoot},row:"fragmentContainer:",renderOptions:{cutpoints:e}}},pagerBar:{type:"fluid.pager.pagerBar",options:{pageList:{type:"fluid.pager.renderedPageList",options:{linkBody:"a"}}}}};g.state.pager=b.pager(c(d).find(".package-results"),h);g.state.pager.events.initiatePageSizeChange.fire(6);}};g.refresh();g.events.onLoad.fire(g);return g;};b.defaults("up.FragmentBrowser",{fragmentServiceUrl:null,selectors:{fragmentContainer:".package",fragment:".package-wrapper",fragmentTitle:".package-titlebar",fragmentDescription:".package-description",selectFragmentLink:".package-link",pagerRoot:".package-list"},events:{onFragmentSelect:null,onLoad:null},listeners:{onFragmentSelect:null,onLoad:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){var a=function(f){var e,d;e=f.options.currentLayout.join("-");d={children:[]};c(f.options.layouts).each(function(g,i){var j=i.columns.join("-"),h="";if(i.columns.join("-")===e){h+="selected";}if(i.disabled){h+=" disabled";}d.children.push({ID:"layoutContainer:",decorators:[{type:"addClass",classes:h}],children:[{ID:"layout"},{ID:"layoutLink",decorators:[{type:"jQuery",func:"click",args:function(){if(!i.disabled){f.options.currentLayout=i.columns;f.refresh();f.events.onLayoutSelect.fire(i,f);}}}]},{ID:"layoutTitle",value:i.columns.length+" "+f.options.strings[i.columns.length==1?"column":"columns"]},{ID:"layoutDescription",value:f.options.strings[i.nameKey]},{ID:"layoutThumb",decorators:[{type:"attrs",attributes:{style:"background: url("+f.options.imagePath+"layout_"+j+".gif) top left no-repeat;"}}]}]});});return d;};up.LayoutSelector=function(d,f){var g,e;g=b.initView("up.LayoutSelector",d,f);e=[{id:"layoutContainer:",selector:g.options.selectors.layoutContainer},{id:"layout",selector:g.options.selectors.layout},{id:"layoutLink",selector:g.options.selectors.layoutLink},{id:"layoutTitle",selector:g.options.selectors.layoutTitle},{id:"layoutDescription",selector:g.options.selectors.layoutDescription},{id:"layoutThumb",selector:g.options.selectors.layoutThumb}];g.refresh=function(){var h=a(g);b.reRender(g.templates,c(d),h,{cutpoints:e});};g.templates=b.selfRender(c(d),a(g),{cutpoints:e});return g;};b.defaults("up.LayoutSelector",{currentLayout:[50,50],strings:{fullWidth:"Full-width",narrowWide:"Narrow, wide",even:"Even",wideNarrow:"Wide, narrow",narrowWideNarrow:"Narrow, wide, narrow",column:"Column",columns:"Columns",sixColumn:"Narrow Columns"},layouts:[{nameKey:"fullWidth",columns:[100]},{nameKey:"narrowWide",columns:[40,60]},{nameKey:"even",columns:[50,50]},{nameKey:"wideNarrow",columns:[60,40]},{nameKey:"even",columns:[33,34,33]},{nameKey:"narrowWideNarrow",columns:[25,50,25]},{nameKey:"even",columns:[25,25,25,25]},{nameKey:"sixColumn",columns:[17,17,16,16,17,17]}],imagePath:"test/",selectors:{layoutContainer:".layout",layout:".layout-wrapper",layoutLink:".layout-link",layoutTitle:".layout-titlebar",layoutDescription:".layout-description",layoutThumb:".layout-thumb"},events:{onLayoutSelect:null},listeners:{onLayoutSelect:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(d,e){var a=function(l,j,m,k){return{key:l,name:j,description:m,thumbnailPath:k,thumbnailAlt:(j+" Thumbnail")};};var b=function(j){return[{id:"listItem-row:",selector:j.options.selectors.listItem},{id:"skinWrapper",selector:j.options.selectors.skinWrapper},{id:"skinLink",selector:j.options.selectors.skinLink},{id:"skinName",selector:j.options.selectors.skinName},{id:"skinThumbnail",selector:j.options.selectors.skinThumbnail}];};var f=function(k){var l,j;l=[];j=e.transform(k.state.model,function(n,m){return{ID:"listItem-row:",decorators:[{type:"addClass",classes:n.key===k.options.currentSkin?k.options.activeSkin:""}],children:[{ID:"skinWrapper"},{ID:"skinLink",decorators:[{type:"jQuery",func:"click",args:function(){var p,o,q;p=k.locate("skinList");p.find("."+k.options.activeSkin).removeClass(k.options.activeSkin);o=d(this);o.addClass(k.options.activeSkin);k.events.onSelectSkin.fire(n);}}]},{ID:"skinName",value:n.name,decorators:[{type:"attrs",attributes:{title:n.name}}]},{ID:"skinThumbnail",decorators:[{type:"attrs",attributes:{style:"background: url("+n.thumbnailPath+") top left no-repeat;"}}]}]};});return l.concat(j);};var h=function(j){return{children:f(j)};};var g=function(l){var k,j;k=l.locate("skinList");j={cutpoints:b(l),model:l.state.model,autoBind:true};l.state.templates=e.selfRender(k,h(l),j);k.find('input[value="'+l.options.currentSkin+'"]').parents(".widget").addClass(l.options.activeSkin);};var i=function(j){d.ajax({url:j.options.skinListURL,async:true,dataType:"xml",type:"GET",success:function(m){var l,k,n;l=d(m);k=l.find("skin");n=j.locate("skinList");d.each(k,function(o,u){var t,r,p,s,q;t=d(u);r=t.children("skin-key").text();p=t.children("skin-name").text();s=t.children("skin-description").text();q=(j.options.mediaPath+"/"+r+"/thumb.gif");j.state.model.push(a(r,p,s,q));});g(j);},error:function(k,m,l){if(console){console.log("AJAX Failure: ",k,m,l);}}});};var c=function(k){var j;k.state={};k.state.model=[];i(k);};up.SkinSelector=function(j,k){var l;l=e.initView("up.SkinSelector",j,k);l.refresh=function(){var m;m={cutpoints:b(l),model:l.state.model,autoBind:true};e.reRender(l.state.templates,l.locate("skinList"),h(l),m);};c(l);return l;};e.defaults("up.SkinSelector",{selectors:{skinList:".skins-list",listItem:".skin",skinWrapper:".skins-wrapper",skinLink:".skin-link",skinName:".skin-titlebar",skinThumbnail:".skin-thumb"},events:{onSelectSkin:null},currentSkin:null,skinListURL:null,mediaPath:null,activeSkin:"selected"});})(jQuery,fluid);
"use strict";var up=up||{};(function(g,e){e.inlineEdit.setupEditContainer=function(l,i,k){var j=g(k);j=j.length?j:g("<div class='fl-inlineEditContainer'></div>");l.parent().after(j);j.append(i);return j;};e.inlineEdit.setupTextEditButton=function(l){var k=l.options;var i=l.locate("textEditButton");if(i.length===0){var j=g("<span class='flc-inlineEdit-textEditButton'></span>");j.addClass(k.styles.textEditButton);e.inlineEdit.updateTextEditButton(j,l.model.value||k.defaultViewText,k.strings.textEditButton);l.events.modelChanged.addListener(function(){e.inlineEdit.updateTextEditButton(j,l.model.value||k.defaultViewText,k.strings.textEditButton);});l.locate("text").after(j);i=l.locate("textEditButton");}return i;};var d=function(l){var k,i,m,j,o,n;k=l.locate("edit");i=l.locate("remove");j=l.locate("grabHandle");if(k.length>0){l.inlineEditor=e.inlineEdits(l.container,{selectors:{text:l.options.selectors.text,edit:l.options.selectors.edit},listeners:{afterBeginEdit:function(){i.hide();j.hide();k.hide();},afterFinishEdit:function(s,q,r,p){i.show();j.filter(".active").show();k.show();l.events.onTabEdit.fire(s,q,r,p);}},submitOnEnter:l.options.submitOnEnter,useTooltip:false});m=l.locate("text");m.bind("mouseenter",function(){m.css("cursor","text");m.focus();});m.bind("mouseleave",function(){m.css("cursor","pointer");m.blur();});n=parseInt(l.options.numberOfPortlets);if(n===0&&m.text()===l.options.addTabLabel){m.trigger("click");}}};var f=function(j){var i;i=j.locate("remove");i.bind("click",function(){j.events.onTabRemove.fire(this);});};var c=function(j){var k,i;k=j.locate("add");i=j.container.find(j.options.selectors.tabGroup).text();k.bind("click",function(){j.events.onTabAdd.fire(j.options.addTabLabel,j.options.addTabWidths,i);});};var b=function(i){i.reorderLayout=e.reorderLayout(i.container,{selectors:{columns:i.options.selectors.columns,modules:i.options.selectors.modules,lockedModules:i.options.selectors.lockedModules,grabHandle:(i.options.tabContext==="header")?i.options.selectors.grabHandle:""},styles:{defaultStyle:"fl-reorderer-"+i.options.tabContext+"-movable-default",selected:"fl-reorderer-"+i.options.tabContext+"-movable-selected",dragging:"fl-reorderer-"+i.options.tabContext+"-movable-dragging",mouseDrag:"fl-reorderer-"+i.options.tabContext+"-movable-dragging",hover:"fl-reorderer-"+i.options.tabContext+"-movable-hover",dropMarker:"fl-reorderer-"+i.options.tabContext+"-dropMarker",avatar:"fl-reorderer-"+i.options.tabContext+"-avatar"},listeners:{afterMove:function(s,q,k){var m,l,j,p,o,r,n;m=g(s);l=up.defaultNodeIdExtractor(m);j=i.options.insertBefore;p=null;o=null;r=1;n=i.locate("tabListItems");if(m.is(":last-child")){j=i.options.appendAfter;p=m.prev();o=m.prev().attr("id").split("_")[1];}else{p=m.next();o=m.next().attr("id").split("_")[1];}g.each(n,function(u,v){var t=g(v);if(t.attr("id")===m.attr("id")){r=(u+1);}if(n.length===1){t.removeClass(i.options.styles.firstTab).removeClass(i.options.styles.lastTab).addClass(i.options.styles.singleTab);}else{if(u===0){t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.lastTab).addClass(i.options.styles.firstTab);}else{if(u===(n.length-1)){t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.firstTab).addClass(i.options.styles.lastTab);}else{t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.lastTab).removeClass(i.options.styles.firstTab);}}}});i.events.onTabMove.fire(l,j,o,r);}}});};var h=function(k){var j,i;j=k.locate("tabList");i=j.find(k.options.selectors.lockedModules).last();if(i.length>0){i.find(k.options.selectors.grabHandle).hide();i.prevAll().addClass(k.options.styles.lockedTab).find(k.options.selectors.grabHandle).hide();}b(k);};var a=function(i){d(i);f(i);c(i);h(i);};up.TabManager=function(i,j){var k;k=e.initView("up.TabManager",i,j);a(k);return k;};e.defaults("up.TabManager",{selectors:{text:".flc-inlineEdit-text",edit:".flc-inlineEditable",remove:".portal-navigation-delete",add:".portal-navigation-add",columns:".flc-reorderer-column",modules:".movable,.up-fragment-admin",lockedModules:".locked:not(.up-fragment-admin)",grabHandle:".portal-navigation-gripper",tabList:"#portalNavigationList",tabListItems:".portal-navigation",tabGroup:"#activeTabGroup"},events:{onTabEdit:null,onTabRemove:null,onTabAdd:null,onTabMove:null},styles:{lockedTab:"locked",singleTab:"single",firstTab:"first",lastTab:"last"},addTabLabel:"My Tab",addTabWidths:[50,50],insertBefore:"insertBefore",appendAfter:"appendAfter",tabContext:"header",numberOfPortlets:0,submitOnEnter:true});})(jQuery,fluid);
var up=up||{};(function(b,a){up.LayoutPreferencesPersistence=function(c,d){var e=a.initView("up.LayoutPreferencesPersistence",c,d);e.update=function(f,g){b.ajax({url:e.options.saveLayoutUrl,type:"POST",data:f,dataType:"json",async:false,success:g,error:function(i,j,h){e.events.onError.fire(e,i,j,h);}});};return e;};a.defaults("up.LayoutPreferencesPersistence",{saveLayoutUrl:null,selectors:{errorMessage:".layout-persistence-error-message"},messages:{error:"Error persisting layout change"},events:{onSuccess:null,onError:null},listeners:{onSuccess:null,onError:function(e,d,f,c){if(console){console.log(d,f,c);}e.locate("errorMessage").text(e.options.messages.error);}}});})(jQuery,fluid);
var uportal=uportal||{};(function(b,a){up.UrlProvider=function(c,d){var e=a.initView("up.UrlProvider",c,d);e.getPortletUrl=function(f){return e.options.portalContext+"/p/"+f;};e.getTabUrl=function(f){return e.options.portalContext+"/f/"+f;};e.getPortalHomeUrl=function(){return e.options.portalContext+"/";};return e;};a.defaults("up.UrlProvider",{portalContext:"/uPortal"});})(jQuery,fluid);
var uportal=uportal||{};(function(b,d){var i=[{nameKey:"fullWidth",columns:[100]},{nameKey:"narrowWide",columns:[40,60]},{nameKey:"even",columns:[50,50]},{nameKey:"wideNarrow",columns:[60,40]},{nameKey:"even",columns:[33,34,33]},{nameKey:"narrowWideNarrow",columns:[25,50,25]},{nameKey:"even",columns:[25,25,25,25]},{nameKey:"sixColumn",columns:[17,17,16,16,17,17]}];var e=".deletable:not(:has(.locked)),.up-fragment-admin";var g=function(){return up.defaultNodeIdExtractor(b("#portalNavigationList li.active"));};var a={ERROR:"error",WARN:"warn",SUCCESS:"success"};var j=function(o,n,p){var l=b("#portalPageBodyMessage");if(o&&n){var m=(n==a.ERROR)?5000:2000;if(l.length!=0){l.html("<p>"+o+"</p>");l.removeClass().addClass(n).show().delay(m).fadeOut(400,p);}else{return p;}}else{return p;}};var f=function(){var l=[];b("#portalPageBodyColumns > [id^=column_]").each(function(){var m=b(this).get(0).className.match("fl-container-flex[0-9]+");if(m!=null){l.push(Number(m[0].match("[0-9]+")[0]));}});if(l.length==0){l.push(100);}return l;};var h=function(){var m=b("#portalPageBodyColumns > [id^=column_]");var o=m.filter(e);var n=o.filter(":has(.up-portlet-wrapper)");if(n.size()>0){var l=m.filter(".canAddChildren,.up-fragment-admin");if(l.size()==0){o=o.filter(":not(:has(.up-portlet-wrapper))");}}return o;};var k=function(){var q=b("#portalNavigation_"+g()).filter(".canAddChildren,.up-fragment-admin");var p=b("#portalPageBodyColumns > [id^=column_]");var s=p.filter(e);var m=p.length-s.length;var r=s.filter(":has(.up-portlet-wrapper)");if(r.size()>0){var n=p.filter(".canAddChildren,.up-fragment-admin");if(n.size()==0){s=s.filter(":not(:has(.up-portlet-wrapper))");m=p.length-s.length;}else{var l=false;for(var o=0;o<n.length;o++){if(b.inArray(n[o],s)<0){l=true;break;}}if(!l){m++;}}}b(i).each(function(t,w){var v=!q&&w.columns.length>p.length,u=w.columns.length<m;if(v||u){w.disabled=true;}});return i;};var c=function(q,r){var u=q.columns;var s=b("#portalPageBodyColumns [id^=column_]").size();var v={action:"changeColumns",tabId:g(),widths:u};if(u.length<s){var t=s-u.length;var l=h();v.deleted=[];var p=[];for(var n=0;n<t;n++){p.push(l[l.length-n-1]);v.deleted.push(up.defaultNodeIdExtractor(l[l.length-n-1]));}var o=b("#portalPageBodyColumns > [id^=column_]").filter(".canAddChildren,.up-fragment-admin");var m=o.filter(":first");v.acceptor=up.defaultNodeIdExtractor(m);}r.persistence.update(v,function(w){b(w.newColumnIds).each(function(){var y=this;var x=b(document.createElement("div")).attr("id","column_"+y).addClass("portal-page-column movable deletable editable canAddChildren").html('<div id="inner-column_'+y+'" class="portal-page-column-inner"></div>');if(b("#portalPageBodyColumns").has(".up-fragment-admin")){x.addClass("up-fragment-admin");}b("#portalPageBodyColumns").append(x);});b(p).each(function(x,y){b(this).find("[id^=portlet_]").each(function(z,A){b(A).appendTo(m);});b(this).remove();});b("#portalPageBodyColumns > [id^=column_]").each(function(y){var z=b(this).removeClass("column-1 column-2 column-3 column-4 column-5 column-6");var x="column-"+(y+1);b(z).addClass(x);b(this.className.split(" ")).each(function(B,C){if(C.match(r.options.columnWidthClassPattern)){b(z).removeClass(C);}});var A=r.options.columnWidthClassFunction(u[y]);b(z).addClass(A);});b("#portalPageBodyColumns").attr("class","columns-"+u.length);r.components.gallery.refreshPaneLink();r.components.portletReorderer.refresh();});};up.LayoutPreferences=function(l,m){var n=d.initView("up.LayoutPreferences",l,m);n.persistence=up.LayoutPreferencesPersistence(l,{saveLayoutUrl:n.options.layoutPersistenceUrl,messages:{error:n.options.messages.persistenceError}});n.urlProvider=up.UrlProvider(l,{portalContext:n.options.portalContext});n.components={};if(n.options.gallerySelector&&b(n.options.gallerySelector).length>0){n.components.gallery=up.PortalGallery(n.options.gallerySelector,{browseContentPane:{options:{portletBrowser:{options:{portletRegistry:{options:{portletListUrl:n.options.channelRegistryUrl}},searchView:{options:{searchInvitationMessage:n.options.messages.searchForStuff}},categoryListView:{options:{rootCategoryName:n.options.messages.allCategories}},listeners:{onPortletSelect:function(p,r){var o,q;o={action:"addPortlet",channelID:r.id};q=b("[id^=portlet_].movable,[id^=portlet_].up-fragment-admin").first();if(q.size()==0){o.elementID=g();}else{o.elementID=up.defaultNodeIdExtractor(q);o.position="insertBefore";}n.persistence.update(o,function(s){if(s.error){j(s.error,a.ERROR);}else{window.location=n.urlProvider.getTabUrl(g());}});},onPortletDrag:function(p,q,o){n.persistence.update({action:"addPortlet",channelID:p.id,position:q,elementID:o},function(r){if(r.error){j(r.error,a.ERROR);}else{window.location=n.urlProvider.getTabUrl(g());}});}}}},fragmentBrowser:{options:{fragmentServiceUrl:n.options.subscribableTabUrl,listeners:{onFragmentSelect:function(r,q){var o,p;o=b("[id*=portalNavigation_]:last");p=up.defaultNodeIdExtractor(o);n.persistence.update({action:"subscribeToTab",sourceID:q.ownerID,method:"appendAfter",elementID:p},function(s){window.location=n.urlProvider.getTabUrl(s.tabId);});}}}}}},useContentPane:{options:{listeners:{onInitialize:function(o){up.PortletBrowser(".use-content",o,{portletRegistry:{options:{portletListUrl:n.options.channelRegistryUrl}},categoryListView:{type:"up.AjaxLayoutCategoryListView",options:{rootCategoryName:n.options.messages.allCategories}},portletListView:{type:"up.AjaxLayoutPortletListView"},searchView:{options:{searchInvitationMessage:n.options.messages.searchForStuff}},listeners:{onPortletSelect:function(p,q){window.location=n.urlProvider.getPortletUrl(q.fname);}}});}}}},skinPane:{options:{listeners:{onInitialize:function(o){up.SkinSelector(".skins",{listeners:{onSelectSkin:function(p){n.persistence.update({action:"chooseSkin",skinName:p.key},function(q){window.location=n.urlProvider.getTabUrl(g());});}},currentSkin:n.options.currentSkin,skinListURL:(n.options.mediaPath+"/skinList.xml"),mediaPath:n.options.mediaPath});}}}},layoutPane:{options:{listeners:{onInitialize:function(o){up.LayoutSelector(".layouts-list",{currentLayout:f(),layouts:k(),imagePath:n.options.mediaPath+"/common/images/",listeners:{onLayoutSelect:function(q,p){c(q,n);}},strings:n.options.messages});}}}}});}n.components.tabManager=up.TabManager("#portalNavigation",{listeners:{onTabEdit:function(r,p,q,o){n.persistence.update({action:"renameTab",tabId:g(),tabName:r});},onTabRemove:function(p){if(!confirm(n.options.messages.confirmRemoveTab)){return false;}var o,q;o=p.parentNode;q=up.defaultNodeIdExtractor(o);n.persistence.update({action:"removeElement",elementID:q},function(r){window.location=n.urlProvider.getPortalHomeUrl();});},onTabAdd:function(o,p,q){n.persistence.update({action:"addTab",tabName:o,widths:p,tabGroup:q},function(r){window.location=n.urlProvider.getTabUrl(r.tabId);});},onTabMove:function(q,r,p,o){n.persistence.update({action:"moveTab",sourceID:q,method:r,elementID:p,tabPosition:o});}},tabContext:n.options.tabContext,numberOfPortlets:n.options.numberOfPortlets,addTabLabel:n.options.messages.addTabLabel});if(b("[id*=toolbar_]").length>0){n.components.portletReorderer=up.fluid.reorderLayout("#portalPageBodyColumns",{selectors:{columns:".portal-page-column-inner",modules:".up-portlet-wrapper",lockedModules:".locked:not(.up-fragment-admin)",dropWarning:b("#portalDropWarning"),grabHandle:"[id*=toolbar_] .grab-handle"},listeners:{afterMove:function(q){var u="insertBefore";var s=null;if(b(q).nextAll("[id^=portlet_]").size()>0){s=b(q).nextAll("[id^=portlet_]").get(0);}else{if(b(q).prevAll("[id^=portlet_]").size()>0){s=b(q).prevAll("[id^=portlet_]").get(0);u="appendAfter";}else{s=b(q).parent();}}var p=b("#portalPageBodyColumns > [id^=column_]");var o={action:"movePortlet",method:u,elementID:up.defaultNodeIdExtractor(s),sourceID:up.defaultNodeIdExtractor(q)};var t=false;n.persistence.update(o,function(v){if(!v.error){t=true;}});if(!t&&confirm(n.options.messages.movePortletError)){location.reload();}var r=b(q).find(".up-portlet-control.move");r.text(r.attr("data-move-text"));b(q).find(".up-portlet-titlebar .grab-handle").addClass("hidden");}},styles:{mouseDrag:"fl-reorderer-movable-dragging-mouse"}});}b("a[id*=removePortlet_]").click(function(){var o=up.defaultNodeIdExtractor(this);if(!confirm(n.options.messages.confirmRemovePortlet)){return false;}b("#portlet_"+o).remove();b("#portalSubnavLink_"+o).remove();n.persistence.update({action:"removeElement",elementID:o});return false;});return n;};d.defaults("up.LayoutPreferences",{tabContext:"header",numberOfPortlets:0,portalContext:"/uPortal",layoutPersistenceUrl:"/uPortal/api/layout",channelRegistryUrl:"/uPortal/api/portletList",subscribableTabUrl:"/uPortal/api/subscribableTabs.json",mediaPath:null,currentSkin:null,isFragmentMode:false,gallerySelector:".up-gallery",columnWidthClassPattern:"fl-container-flex",columnWidthClassFunction:function(l){return"fl-container-flex"+l;},messages:{persistenceError:"Error persisting layout change"}});up.FocusedLayoutPreferences=function(l,m){var n=d.initView("up.FocusedLayoutPreferences",l,m);n.persistence=up.LayoutPreferencesPersistence(l,{saveLayoutUrl:n.options.layoutPersistenceUrl,messages:{error:n.options.messages.persistenceError}});n.urlProvider=up.UrlProvider(l,{portalContext:n.options.portalContext});n.components={};b("#focusedContentDialogLink").click(function(){b(".focused-content-dialog").dialog({width:500,modal:true});b(".focused-content-dialog form").submit(function(){var p,o,q;q=this;p=q.portletId.value;o=b(q).find("[name=targetTab]:checked").val();n.persistence.update({action:"addPortlet",channelID:p,position:"insertBefore",elementID:o},function(r){window.location=n.urlProvider.getTabUrl(o);});return false;});b(this).unbind("click").click(function(){b(".focused-content-dialog").dialog("open");});});return n;};d.defaults("up.FocusedLayoutPreferences",{portalContext:"/uPortal",layoutPersistenceUrl:"/uPortal/api/layout",messages:{persistenceError:"Error persisting layout change"}});
})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.Autocomplete=function(c,e){var f=a.initView("up.Autocomplete",c,e);f.state=f.state||{};var d=[{id:"match:",selector:f.options.selectors.match},{id:"matchLink",selector:f.options.selectors.matchLink},{id:"matchText",selector:f.options.selectors.matchText}];f.search=function(){f.locate("input").removeClass("up-autocomplete-validinput");f.locate("dropdown").show();var h=f.options.searchFunction(f.locate("input").val());var g={children:[]};b(h).each(function(j,i){g.children.push({ID:"match:",children:[{ID:"matchLink",decorators:[{type:"jQuery",func:"click",args:function(){f.locate("input").val(i.text);f.state.currentValue=i.value;f.locate("dropdown").hide();f.locate("input").addClass("up-autocomplete-validinput");}}]},{ID:"matchText",value:i.text}]});});if(f.state.templates){a.reRender(f.state.templates,f.locate("matches"),g,{cutpoints:d});}else{f.state.templates=a.selfRender(f.locate("matches"),g,{cutpoints:d});}f.locate("loadingMessage").hide();};f.getValue=function(){return f.state.currentValue;};f.locate("close").click(function(){f.locate("dropdown").hide();});f.locate("input").keyup(f.search);f.locate("input").focus(function(){var g=f.locate("input").val();if(g==f.options.initialText){f.locate("input").val("");}});f.locate("input").blur(function(){var g=f.locate("input").val();if(g==""){f.locate("input").val(f.options.initialText);}});return f;};a.defaults("up.Autocomplete",{initialText:"",searchFunction:null,selectors:{input:".up-autocomplete-searchterm",dropdown:".up-autocomplete-dropdown",close:".up-autocomplete-close",noResultsMessage:".up-autocomplete-noresults",matches:".up-autocomplete-matches",match:".up-autocomplete-match",matchLink:".up-autocomplete-match-link",matchText:".up-autocomplete-match-text",loadingMessage:".up-autocomplete-loading"},events:{onSearch:null,onClose:null},listeners:{onSearch:null,onClose:null}});})(jQuery,fluid);
var up=up||{};(function(c,b){var d=function(e){c(e.locate("stacktracediv")).hide();};var a=function(h){var e=c(h.locate("stacktracetoggle"));var i=c(h.locate("stacktracediv"));var f=h.options.hidemessage;var g=h.options.showmessage;e.toggle(function(){i.show("fast",function(){e.text(f);});},function(){i.hide("fast",function(){e.text(g);});});};up.showHideToggle=function(e,f){var g=b.initView("up.showHideToggle",e,f);d(g);a(g);return g;};b.defaults("up.showHideToggle",{showmessage:"Show Stack Trace",hidemessage:"Hide Stack Trace",selectors:{stacktracediv:".stacktrace",stacktracetoggle:".stacktracetoggle"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(f,j){var c=function(u){var v=u.indexOf(":");return u.substring(0,v);};var o=function(u){var v=u.indexOf(":");return u.substring(v+1,u.length);};var m=function(u){return u.entityType+":"+u.id;};var q=function(x,v,w){var u=undefined;switch(w){case false:u='<span class="selection" title="'+x.options.messages.nothingSelected+'">'+x.options.messages.nothingSelected+"</span>";break;case true:u='<a href="javascript:;" title="'+x.options.messages.removeSelection+'" key="'+m(v)+'" class="'+x.options.styles.selection+'">'+v.name+'</a><input type="hidden" name="groups" value="'+m(v)+'"/>';break;}return u;};var t=function(v,x,w,u){v.unbind("click");if(x.find("a[key='"+u+"']").size()>0){v.text("Remove from Selection ").append("<i class='fa fa-minus-circle'></i>");v.removeClass("btn-success").addClass("btn-danger");v.bind("click",function(y){k(w,u);});}else{v.text("Add to Selection ").append("<i class='fa fa-plus-circle'></i>");v.removeClass("btn-danger").addClass("btn-success");v.bind("click",function(y){r(w,u);});}};var g=function(x){var w,y,v,u;y=x.locate("selectionBasket");v=x.locate("currentSelectBtn");u=x.locate("currentEntityName").attr("key");t(v,y,x,u);w=x.locate("entityBrowserContent");w.find("button.btn-select").each(function(){u=f(this).attr("key");t(f(this),y,x,u);});};var k=function(y,w){var z,v,u,x;z=y.locate("selectionBasket");u=y.locate("buttonPrimary");v=y.registry.getEntity(c(w),o(w));x=[];switch(y.selectMultiple){case false:y.options.selected=[];z.html(q(y,v,false));break;case true:z.find("a").each(function(){var A=f(this);if(A.attr("key")!==w){x.push(A.attr("key"));}else{A.parent().remove();}});y.options.selected=x;break;}g(y);if(y.options.selected.length<1&&y.options.requireSelection){u.attr("disabled","disabled");}};var r=function(y,x){var z,v,u,w;z=y.locate("selectionBasket");v=y.locate("buttonPrimary");w=y.registry.getEntity(c(x),o(x));switch(y.selectMultiple){case false:y.options.selected=[];y.options.selected.push(x);z.html(q(y,w,true));z.find("a").click(function(){y.options.selected=[];z.html(q(y,w,false));k(y,f(this).attr("key"));});break;case true:if(f.inArray(x,y.options.selected)<0){y.options.selected.push(x);u=f('<li><a href="javascript:;" key="'+m(w)+'">'+w.name+'</a><input type="hidden" name="groups" value="'+m(w)+'"/></li>');z.find("ul").append(u);u.find("a").click(function(){k(y,f(this).attr("key"));});}break;}g(y);v.removeAttr("disabled");};var d=function(y,v,x){var u,w;u=v.parent();w=u.nextAll();w.remove();x(y,v.attr("key"));};var b=function(y,w,v,u,x){var z;z='<span><a href="javascript:;" title="'+v+'" key="'+w+'">'+v+"</a> &gt; </span>";u.append(z);u.find("a").unbind("click").click(function(){d(y,f(this),x);});};var h=function(y,v,z,x){var u,w,A;u=y.locate(z);w=m(v);if(u.find("span").length>0){A=(u.find('span a[key="'+w+'"]').length>0)?true:false;if(!A){b(y,w,v.name,u,x);}}else{b(y,w,v.name,u,x);}u.find("."+y.options.styles.last).removeClass(y.options.styles.last).css("visibility","visible");u.find("span:last").addClass(y.options.styles.last).css("visibility","hidden");};var p=function(y,v){console.log("browse ad hoc");var u,w,x;u=y.registry.getEntity(c(v),o(v));y.currentAdHocGroup=u;w=y.locate("currentEntityName");w.text(u.name);w.attr("key",m(u));h(y,u,"breadcrumbs",p);x=y.locate("entityBrowserContent");x.find("table").each(function(){f(this).html("").hide();});f.each(u.children,function(H,A){var C,B,D,F,J,E,I,G,z;z=A.entityType.toLowerCase();if(z=="person"||z=="portlet"){G=document.createElement("span");G.textContent=A.name;}else{G=document.createElement("a");G.href="javascript:;";G.text=A.name;G.setAttribute("key",m(A));}G.className=y.options.styles.memberLink;C=document.createElement("td");C.appendChild(G);F=document.createElement("button");F.className="btn btn-select btn-success btn-xs";F.setAttribute("key",m(A));F.appendChild(document.createTextNode("Add to Selection "));J=document.createElement("i");J.className="fa fa-plus-circle";F.appendChild(J);D=document.createElement("div");D.className="btn-group pull-right";D.role="group";D.appendChild(F);B=document.createElement("td");B.appendChild(D);E=document.createElement("tr");E.appendChild(C);E.appendChild(B);I=x.find("."+z).find("."+y.options.styles.memberList);I.append(E);I.show();});y.container.find(".no-members").each(function(z,A){A=f(A);if(A.parent().find("tr").size()>0){A.hide();}else{A.show();}});x.find("table").find("a").click(function(){p(y,f(this).attr("key"));});g(y);};var e=function(u){var v;v=u.searchDropDown.find(u.options.selectors.searchResults);v.find("."+u.options.styles.selected).removeClass(u.options.styles.selected);f.each(u.options.selected,function(w,y){var x=v.find('span[key="'+y+'"]');x.parent().parent().addClass(u.options.styles.selected);});};var s=function(w,v){var u=w.registry.getEntity(c(v),o(v));console.log(u);if(f.inArray(v,w.options.selected)!==-1){k(w,m(u));}else{r(w,m(u));}e(w);};var l=function(z,w,y){var B,A,x,v,u;if(w===z.options.messages.searchValue){w="";}B=z.registry.searchEntities(z.options.entityTypes,w);A=z.searchDropDown.find(z.options.selectors.searchResults);v=z.locate("searchResultsNoMembers");A.html("");x="";f.each(B,function(C,D){x+='<li class="'+D.entityType+'"><a href="javascript:;" title="'+D.name+'"><span key="'+m(D)+'">'+D.name+"</span></a></li>";});A.html(x);A.find("a").bind("click",function(){var C=f(this).find("span");console.log(C.attr("key"));s(z,C.attr("key"));});u=A.find("li");if(u.length<1){v.show();A.hide();}else{A.show();v.hide();}e(z);return false;};var i=function(y){var x,w,z,v,u;x=y.locate("closeSearch");w=y.locate("searchForm");z=w.find("input[type=text]");u=y.locate("searchLoader");v=y.locate("searchDropDown");z.val(y.options.messages.searchValue);v.css({top:z.outerHeight()});z.bind("click focus",function(){f(this).val("");});w.submit(function(){up.showLoader(u);l(y,z.val(),w);v.show();up.hideLoader(u);return false;});x.find("a").bind("click",function(){v.hide();});f(document).bind("click",function(A){if(y.isEmptyArray(f(A.target).parents("."+y.options.styles.search))){v.hide();}});};var n=function(u,w){var v=[];f.each(u,function(y,x){v.push({testValue:x,attributeName:w,testerClassName:"org.jasig.portal.groups.pags.testers.AdHocGroupTester"});});return v;};var a=function(w){i(w);w.locate("selectionBasket").find("a").click(function(){k(w,f(this).attr("key"));});p(w,w.options.initialFocusedEntity);if(w.options.enableAdHocGroups){var v=false,u=false;var x=function(A){var C,B;B=[];f.each(A.children,function(D,E){if(E.entityType=="GROUP"){C=w.registry.getEntity(E.entityType,E.id);B.push(x(C));}});return{id:m(A),text:A.name,children:B};};var z=function(D,A){var C,B,E;if(D&&D.id&&D.id.length>5){C=D.id;B=w.registry.getEntity(c(C),o(C));E=[];f.each(B.children,function(F,G){E.push(x(G));});}else{C=w.options.initialFocusedEntity;B=w.registry.getEntity(c(C),o(C));E=[x(B)];}A.call(this,E);};var y=function(A){console.log("display response message");console.log(A.responseText);switch(A.status){case 200:case 201:case 202:f(w.options.selectors.alertSuccess).show();break;case 400:f(w.options.selectors.alertInvalidParent).show();break;case 409:f(w.options.selectors.alertGroupExists).show();break;case 401:case 403:f(w.options.selectors.alertUnauthorized).show();break;default:f(w.options.selectors.alertUnknown).show();break;}};w.locate("saveAdHocButton").bind("click",function(D){var E,C,I,G,B,F,H,A;E=w.locate("currentEntityName").attr("key");C=w.locate("currentEntityName").text();I=[];w.locate("dataIncludesList").find("li").each(function(){I.push(f(this).text());});G=[];w.locate("dataExcludesList").find("li").each(function(){G.push(f(this).text());});B=n(I,"group-member");B=B.concat(n(G,"not-group-member"));F={};F.name=f("#groupName").val();F.description=f("#groupDesc").val();F.testGroups=[{tests:B}];H=JSON.stringify(F);console.log(H);A=new XMLHttpRequest();A.onreadystatechange=function(){if(A.readyState==4){if(A.status>=200&&A.status<=202){w.registry.removeEntity(E);p(w,E);}y(A);}};A.open("POST",w.options.pagsApiUrl+C+".json",true);A.send(H);});f(w.options.selectors.adHocGroupsModal).on("show.bs.modal",function(){f(w.options.selectors.alerts).hide();if(!v){f(w.options.selectors.dialogIncludesTree).jstree({core:{data:z},checkbox:{keep_selected_style:false,three_state:false},plugins:["checkbox"]});}if(!u){f(w.options.selectors.dialogExcludesTree).jstree({core:{data:z},checkbox:{keep_selected_style:false,three_state:false},plugins:["checkbox"]});}});}else{w.locate("adHocCreate").hide();}if(w.options.selected.length<1&&w.options.requireSelection){w.locate("buttonPrimary").attr("disabled","disabled");}};up.entityselection=function(u,v){var w;w=j.initView("up.entityselection",u,v);w.selectMultiple=w.options.selectMultiple;w.searchDropDown=w.locate("searchDropDown");w.registry=j.initSubcomponent(w,"entityRegistry",[u,j.COMPONENT_OPTIONS]);w.isEmptyArray=function(x){return((x.length>0)?false:true);};a(w);return w;};j.defaults("up.entityselection",{entityRegistry:{type:"up.EntityRegistry"},entityTypes:[],selected:[],initialFocusedEntity:"group:local.0",enableAdHocGroups:false,selectMultiple:true,requireSelection:true,pagsApiUrl:"/api/v4-3/pags/",selectors:{alerts:".alert",alertSuccess:"#alertSuccess",alertInvalidParent:"#alertInvalidParent",alertGroupExists:"#alertGroupExists",alertUnauthorized:"#alertUnauthorized",alertUnknown:"#alertUnknown",selectionBasket:"#selectionBasket",breadcrumbs:"#entityBrowsingBreadcrumbs",currentEntityName:"#currentEntityName",entityBrowserContent:"#entityBrowserContent",closeSearch:"closeDropDown",searchForm:"#searchForm",searchDropDown:"#searchDropDown",searchResults:"#searchResults",searchResultsNoMembers:"#searchResultsNoMembers",searchLoader:"searchLoader",currentSelectBtn:"#currentSelectBtn",adHocCreate:"#adHocCreate",adHocGroupsModal:"#adhocGroupModal",dialogIncludesTree:"#dataIncludes",dataIncludesList:"#dataIncludesList",dialogExcludesTree:"#dataExcludes",dataExcludesList:"#dataExcludesList",saveAdHocButton:"#saveAdHocButton",buttonPrimary:"#buttonPrimary"},styles:{memberList:"member-list",memberLink:"member-link",selection:"selection",selected:"selected",last:"last",title:"title",search:"portlet-search"},messages:{selectButtonMessage:"",deselectButtonMessage:"",removeCrumb:"",removeSelection:"",addSelection:"",selected:"",nothingSelected:"",searchValue:""}});
})(jQuery,fluid);
var up=up||{};(function(d,f){var e=function(j,k){return k.options.parameterBindName+"['"+k.options.parameterNamePrefix+j+"'].value";};var b=function(j,k){return k.options.auxiliaryBindName+"['"+k.options.parameterNamePrefix+j+"'].value";};var h=function(m,l){var o,p,k,j,n;k=d(m).find("input[name=name]").val();j=b(k,l);o=d(document.createElement("tr"));o.append(d(document.createElement("td")).text(k));p=d(document.createElement("td"));o.append(p);if(l.options.multivalued){p.append(d(document.createElement("a")).attr("href","javascript:;").attr("paramName",k).addClass(l.options.displayClasses.addValueLink).addClass(l.options.displayClasses.addValueLinkExtraClass).text(l.options.messages.addValue).click(function(){a(d(this),l);}).append('&nbsp;&nbsp;<i class="fa fa-plus-circle"></i>').append(d(document.createElement("input")).attr({name:e(k,l),type:"text"}).addClass(l.options.displayClasses.inputElementExtraClass).hide()));a(p.find("."+l.options.displayClasses.addValueLink),l);}else{p.append(d(document.createElement("input")).attr({name:j,type:"text"}).addClass(l.options.displayClasses.inputElementExtraClass));}if(l.options.useAuxiliaryCheckbox){n=d(document.createElement("input")).attr("type","checkbox").attr("name",b(k,l)).val("true");o.append(d(document.createElement("td")).append(n));}o.append(d(document.createElement("td")).append(d(document.createElement("a")).text(l.options.messages.removeParameter).addClass(l.options.displayClasses.deleteItemLink).addClass(l.options.displayClasses.deleteItemLinkExtraClass).attr("href","javascript:;").append('&nbsp;&nbsp;<i class="fa fa-trash-o"></i>').click(function(){g(d(this),l);})));l.locate("preferencesTable").append(o);l.options.dialog.dialog("close");return false;};var g=function(k,j){d(k).parent().parent().remove();};var a=function(l,k){var j,m;l=d(l);j=e(l.attr("paramName"),k);l.before(d(document.createElement("div")).append(d(document.createElement("input")).attr({name:j,type:"text"}).addClass(k.options.displayClasses.inputElementExtraClass)).append("  ").append(d(document.createElement("a")).attr("href","javascript:;").addClass(k.options.displayClasses.deleteValueLink).addClass(k.options.displayClasses.deleteValueLinkExtraClass).text(k.options.messages.remove).append('&nbsp;&nbsp;<i class="fa fa-minus-circle"></i>').click(function(){c(d(this),k);})));};var c=function(k,j){d(k).parent().remove();};var i=function(k){var j=k.options.dialog;if(k.options.dialogInitialized){j.find("form").get(0).reset();j.dialog("open");}else{j.find("form").submit(function(){return h(this,k);});j.dialog();k.options.dialogInitialized=true;}};up.ParameterEditor=function(j,k){var l=f.initView("up.ParameterEditor",j,k);j=d(j);j.find("."+l.options.displayClasses.deleteItemLink).click(function(){g(this,l);});j.find("."+l.options.displayClasses.deleteValueLink).click(function(){c(this,l);});j.find("."+l.options.displayClasses.addValueLink).click(function(){a(this,l);});j.find("."+l.options.displayClasses.addItemLink).click(function(){i(l);});l.options.dialogInitialized=false;};f.defaults("up.ParameterEditor",{parameterNamePrefix:"",parameterBindName:"",auxiliaryBindName:"",useAuxiliaryCheckbox:false,dialog:null,multivalued:false,displayClasses:{deleteItemLink:"delete-parameter-link",deleteItemLinkExtraClass:"",deleteValueLink:"delete-parameter-value-link",deleteValueLinkExtraClass:"",addItemLink:"add-parameter-link",addItemLinkExtraClass:"",addValueLink:"add-parameter-value-link",addValueLinkExtraClass:"",inputElementExtraClass:""},messages:{remove:"Remove",removeParameter:"Delete Preference",addValue:"Add value"},selectors:{preferencesTable:"tbody"}});})(jQuery,fluid);
var uportal=uportal||{};(function(c,b){var d=function(e){a(e);c(e.container).mouseover(function(){var h,f,g,i,j;h=c(this);f=e.locate("flyoutMenu");g=e.locate("flyoutList");if(g.html()!==""){e.openFlyout();}if(e.options.orientation==="horizontal"){if(e.options.horzalign==="left"){j=0;}else{j=h.outerWidth()-f.outerWidth();}if(e.options.vertalign==="bottom"){i=(h.outerHeight()-e.options.offset);}else{i=f.outerHeight()*-1;}}else{if(e.options.horzalign==="left"){j=f.outerWidth()*-1;}else{j=h.outerWidth();}if(e.options.vertalign==="bottom"){i=0;}else{i=(f.outerHeight()-h.outerHeight())*-1;}}c(e.container).mouseout(function(){e.closeFlyout();});f.css({top:i,left:j}).bgiframe();});};var a=function(e){if(c.browser.msie){if(c.browser.version==="7.0"){e.locate("flyoutMenu").parents().each(function(){var f=c(this);var g=f.css("position");if(g=="relative"||g=="absolute"||g=="fixed"){c(this).addClass(e.options.styles.onTop);}});return;}}};uportal.flyoutmenu=function(e,f){var g=b.initView("uportal.flyoutmenu",e,f);d(g);g.openFlyout=function(){g.locate("flyoutMenu").show();};g.closeFlyout=function(){g.locate("flyoutMenu").hide();};};b.defaults("uportal.flyoutmenu",{orientation:"horizontal",horzalign:"left",vertalign:"bottom",offset:0,selectors:{flyoutMenu:".portal-flyout-container",flyoutList:".portal-subnav-list"},styles:{onTop:"on-top"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.TranslatorPortlet=function(d,o){var j=a.initView("up.TranslatorPortlet",d,o);var h=null;var n=function(){j.options.entity=null;var r=[{ID:"code",value:""},{ID:"locale",value:j.options.locale},{ID:"value",value:""}];var p=[{selector:".uptrans-mfrm-code",id:"code"},{selector:".uptrans-mfrm-loc",id:"locale"},{selector:".uptrans-mfrm-value",id:"value"}];var q=j.locate("messageForm");q.find(".uptrans-mfrm-code-fieldset").show();a.selfRender(q.show(),r,{cutpoints:p});j.locate("portletForm").hide();j.locate("formContainer").show();};var m=function(){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{action:"getEntity",id:j.options.entity.id,locale:j.options.locale,entity:j.options.entityType},success:function(r){var s=r.message;if(s==null){s={code:j.options.entity.id,locale:j.options.locale,value:""};}var t=[{ID:"code",value:s.code},{ID:"locale",value:s.locale},{ID:"value",value:s.value}];var p=[{selector:".uptrans-mfrm-code",id:"code"},{selector:".uptrans-mfrm-loc",id:"locale"},{selector:".uptrans-mfrm-value",id:"value"}];j.locate("portletForm").hide();j.locate("formContainer").show();var q=j.locate("messageForm");q.find(".uptrans-mfrm-code-fieldset").hide();a.selfRender(q.show(),t,{cutpoints:p});}});};var e=function(){var p=b(this);b.ajax({url:p.attr("action"),type:"POST",data:p.serialize(),success:function(){var q=j.locate("formContainer").find(".portlet-msg-success");q.html(j.options.messages.portletTranslationSaved);q.show();q.fadeOut(4000);}});return false;};var l=function(){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{action:"getEntity",id:j.options.entity.id,locale:j.options.locale,entity:j.options.entityType},success:function(q){var s=q.portlet;var r=[{ID:"id",value:s.id},{ID:"locale",value:s.locale},{ID:"original.title",value:s.original.title},{ID:"localized.title",value:s.localized.title},{ID:"original.name",value:s.original.name},{ID:"localized.name",value:s.localized.name},{ID:"original.description",value:s.original.description},{ID:"localized.description",value:s.localized.description},];var p=[{selector:".uptrans-pfrm-id",id:"id"},{selector:".uptrans-pfrm-loc",id:"locale"},{selector:".uptrans-pfrm-loc-name",id:"localized.name"},{selector:".uptrans-pfrm-loc-title",id:"localized.title"},{selector:".uptrans-pfrm-loc-descr",id:"localized.description"},{selector:".uptrans-pfrm-orig-title",id:"original.title"},{selector:".uptrans-pfrm-orig-name",id:"original.name"},{selector:".uptrans-pfrm-orig-descr",id:"original.description"}];j.locate("messageForm").hide();j.locate("formContainer").show();a.selfRender(j.locate("portletForm").show(),r,{cutpoints:p});}});};var g=function(){if(j.options.entity){if(j.options.entityType=="portlet"){l();}else{if(j.options.entityType=="message"){m();}}}};var i=function(q){j.locate("formContainer").hide();if(j.options.entityType=="message"){j.locate("addMessage").show();}else{j.locate("addMessage").hide();}var r=[];b(q.entities.sort(up.getStringPropertySortFunction("title"))).each(function(s,t){r.push({ID:j.options.namespace+"data:",value:t.title,decorators:[{type:"jQuery",func:"click",args:function(){j.options.entity=t;g();}}]});});var p=[{selector:j.options.selectors.entityList,id:j.options.namespace+"data:"},{selector:j.options.selectors.entity,id:"name"}];if(h==null){h=a.selfRender(j.locate("entities"),r,{cutpoints:p});}else{a.reRender(h,j.locate("entities"),r,{cutpoints:p});}};var k=function(){var p=j.locate("entityType").val();j.options.entityType=j.locate("entityType").val();j.options.entity=null;if(p&&p!=""){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{entity:p,action:"getEntityList"},success:i});}};var c=function(){var p=b(this);b.ajax({url:p.attr("action"),type:"POST",data:p.serialize(),success:function(r){if(j.options.entity==null){k();}var q=j.locate("formContainer").find(".portlet-msg-success");q.html(j.options.messages.messageTranslationSaved);q.show();q.fadeOut(4000);}});return false;};j.locate("entityType").change(k);j.locate("portletForm").submit(e);j.locate("messageForm").submit(c);j.locate("entityForm").submit(function(){return false;});j.locate("addMessage").click(n);var f=j.locate("locale");f.change(function(){j.options.locale=f.val();g();});j.options.locale=f.val();k();return j;};a.defaults("up.TranslatorPortlet",{namespace:"uptrans",locale:null,entityType:null,entity:null,resourceUrl:"",selectors:{entityForm:"#uptrans-form",locale:"#uptrans-locale",entityType:"#uptrans-entityType",entity:".uptrans-entity",entities:"#uptrans-entities",entityList:"#uptrans-entityList",portletForm:"#uptrans-portletForm",messageForm:"#uptrans-messageForm",formContainer:"#uptrans-formContainer",addMessage:"#uptrans-addMessage"},messages:{messageTranslationSaved:"Message translation has been successfully saved",portletTranslationSaved:"Portlet definition translation has been successfully saved"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(g){var f="JSESSIONID",h="/",c;g("#portalSidebar").ready(function(){var k=g("#portalSidebar"),i;if(k.hasClass("sidebarToggle")){if(typeof(c)=="undefined"){c=g.cookie(f);if(c){c=c.split(".")[0];}}if(c){i=d(c,"Sidebar");}if((i&&i=="opened")||(!i&&!(k.hasClass("closed")))){b();}else{a();}g("#portalSidebarToggleButton").click(function(){if(!(k.hasClass("closed"))){a();}else{b();}});g("#portalSidebar .fl-widget-titlebar").click(function(){if(g(this).parents(".fl-widget").hasClass("closed")){g(this).parents(".fl-widget").removeClass("closed");g(this).children("a").attr("title",g(this).find("span.labelclose").text());e(c,"SidebarNth"+g(this).parents(".fl-widget").attr("id"),null);}else{g(this).parents(".fl-widget").addClass("closed");g(this).children("a").attr("title",g(this).find("span.labelopen").text());e(c,"SidebarNth"+g(this).parents(".fl-widget").attr("id"),"closed");}});var n=g(window),m=k.offset(),j=15,l=g("#portalPageBody").offset().top+g("#portalPageBody").height();n.scroll(function(){var o=n.scrollTop(),p=l-k.height();if(n.scrollTop()>m.top&&o<=p){k.stop().animate({marginTop:n.scrollTop()-m.top+j});}else{if(n.scrollTop()>m.top&&o>p){k.stop().animate({top:p-j});}else{k.stop().animate({marginTop:0});}}});}});function a(){g("#portalSidebar").removeClass("opened").addClass("closed");g("#portalSidebarToggleButton").children("a").attr("title",g("#portalSidebarToggleButton").find("h2.textopen").text());e(c,"Sidebar","closed");}function b(){g("#portalSidebar").removeClass("closed").addClass("opened");g("#portalSidebarToggleButton").children("a").attr("title",g("#portalSidebarToggleButton").find("h2.textclose").text());var j=g("#portalSidebar .fl-widget:not(#portalSidebarToggleButton)");var i=j.length-1;while(i>=0){if(d(c,"SidebarNth"+j.eq(i).attr("id"))=="closed"){j.eq(i).addClass("closed");j.eq(i).children("a").attr("title",j.eq(i).find("span.labelopen").text());}else{j.eq(i).removeClass("closed");j.eq(i).children("a").attr("title",j.eq(i).find("span.labelclose").text());}i--;}e(c,"Sidebar","opened");}function e(j,i,k){if(j&&i){g.cookie(j+"."+i,k,{path:h,secure:true});}}function d(j,i){return g.cookie(j+"."+i);}})(jQuery);
"use strict";var up=up||{};(function(a){a(".up-portlet-controls").ready(function(){a("a.up-portlet-control.print").each(function(c){var d=a(this).parent().parent().attr("id").split("_")[1];a(this).attr("id","printPortlet_"+d);a(this).attr("href","javascript:void(0);");a(this).click(function(){b(this.id.split("_")[1]);return false;});var b=function(j){var i="toolbar=yes,location=no,directories=yes,menubar=yes,";i+="scrollbars=yes,width=750,height=600,left=100,top=25,resizable=yes";var e=a("#portletContent_"+j).find("iframe")[0];if(typeof(e)=="object"){var h=window.open(e.src,"",i);h.focus();h.print();return false;}var h=window.open("","",i);var g="<html><head><title>Impression</title>";a("link[rel=stylesheet]").each(function(){g+='<link href="'+this.href+'" rel="'+this.rel+'" type="'+this.type+'"/>\n';});g+="</head>";var f="";a("#portletContent_"+j).parents().each(function(){if(this.tagName.toLowerCase()!="head"&&this.tagName.toLowerCase()!="html"){var k="<"+this.tagName;if(this.id!="undefined"&&this.id!=""){k+=' id="'+this.id+'"';}if(this.className!="undefined"&&this.className!=""){var l=this.className.toLowerCase();l=l.replace(new RegExp("layout-.-columns","gi"),"layout-1-columns");l=l.replace(new RegExp("fl-col-flex.","gi"),"fl-col-flex1");l=l.replace(new RegExp("left","gi"),"single");l=l.replace(new RegExp("fl-col-flex..","gi"),"fl-col-flex");k+=' class="'+l+'"';}k+=" >";f=k+"\n"+f;}});g+=f;g+='<div id="portletContent_'+j+'" class="'+a("#portletContent_"+j).get(0).className+'">';g+=a("#portletContent_"+j).clone().html();g+="</div>";a("#portletContent_"+j).parents().each(function(){g+="</"+this.tagName+">\n";});h.document.write(g);h.document.close();h.focus();h.print();return false;};});});})(jQuery);
var uportal=uportal||{};(function(d,q){var p=function(){if(up.analytics.model==null){return null;}if(q.isArray(up.analytics.model.hosts)){var s=q.find(up.analytics.model.hosts,function(t){if(t.name==up.analytics.host){return t;}});if(s!=null){return s;}}return up.analytics.model.defaultConfig;};var m=function(t){var s={};q.each(t.config||[],function(u){if(u.name!="name"){s[u.name]=u.value;}});ga("create",t.propertyId,s);};var j=function(t){var s={};q.each(t.dimensionGroups||[],function(u){s["dimension"+u.name]=u.value;});ga("set",s);};var b=function(s,u){if(up.analytics.pageData.tab!=null){s=s||up.analytics.pageData.tab.fragmentName;u=u||up.analytics.pageData.tab.tabName;}var t="/";if(s!=null){t+="tab/"+s;if(u!=null){t+="/"+u;}}return t;};var n=function(s,t){if(up.analytics.pageData.tab!=null){s=s||up.analytics.pageData.tab.fragmentName;t=t||up.analytics.pageData.tab.tabName;}var u;if(t!=null){u="Tab: "+t;}else{if(up.analytics.pageData.urlState==null){u="Portal Home";}else{u="No Tab";}}ga("set",{page:b(s,t),title:u});};var c=function(s){var t=up.analytics.portletData[s];if(portletDate==null){return s;}return t.fname;};var i=function(t){var v=d("div.up-portlet-windowId-content-wrapper."+t);if(v==null){return c(t);}var u=v.parents("div.up-portlet-wrapper-inner");if(u==null){return c(t);}var s=u.find("div.up-portlet-titlebar h2 a");if(s==null){return c(t);}return s.text().trim();};var f=function(s){return"/portlet/"+s;};var a=function(t,u){var s=i(t);if(u==null){u=up.analytics.portletData[t];}ga("set",{page:f(u.fname),title:"Portlet: "+s});};var h=function(t,s){if(!q.isArray(s)){s=[s];}var u=t().attr("class");if(u==null){return null;}var v=u.split(/\s+/);return q.find(v,function(w){if(!q.contains(s,w)){return w;}});};var r=function(s){return h(function(){return s.parents("div.up-portlet-fname-subnav-wrapper");},"up-portlet-fname-subnav-wrapper");};var o=function(s){return h(function(){return s.parents("div.up-portlet-windowId-content-wrapper");},"up-portlet-windowId-content-wrapper");};var k=function(v,s,t){var w=v.button==1||v.metaKey||v.ctrlKey||s.attr("target")!=null;var u;if(w){u=function(){};}else{u=function(){document.location=s.attr("href");};}n();ga("send",d.extend({hitType:"event",hitCallback:u},t));if(!w){setTimeout(u,200);v.preventDefault();}};var e=function(){d("ul.fl-tabs li.portal-navigation a.portal-subnav-link").click(function(t){var s=d(this);var u=s.find("span.portal-subnav-label").text();var v=r(s);n();k(t,s,{eventCategory:"Flyout Link",eventAction:f(v),eventLabel:u});});};var g=function(){d("a").click(function(v){var u=d(this);var s=u.prop("hostname");if(s!=""&&s!=document.domain){var t=o(u);if(t!=null){a(t);}else{n();}k(v,u,{eventCategory:"Outbound Link",eventAction:u.prop("href"),eventLabel:u.text()});}});};var l=function(){d("ul.up-portal-nav li.up-tab").click(function(t){var v=d(this);if(v.hasClass("up-tab-open")){return;}var s=h(function(){return v.find("div.up-tab-owner");},"up-tab-owner");var u=v.find("span.up-tab-name").text().trim();n(s,u);ga("send","pageview");});};d(document).ready(function(){window.ga=window.ga||function(){};var s=p();if(s==null){return;}m(s);j(s);n();if(up.analytics.pageData.urlState!="MAX"){ga("send","pageview");}ga("send",{hitType:"timing",timingCategory:"tab",timingVar:b(),timingValue:(up.analytics.pageData.executionTimeNano/1000000)});q.each(up.analytics.portletData,function(u,t){if(u.fname=="google-analytics-config"){return;}a(t,u);ga("send","pageview");ga("send",{hitType:"timing",timingCategory:"portlet",timingVar:f(u.fname),timingValue:(u.executionTimeNano/1000000)});});e();g();l();});})(jQuery,_);
var up=up||{};(function(a){up.notify=function(d,c,b){a("#up-notification").noty({text:d,layout:c,type:b});};a.fn.createRatingModal=function(){var k=this;var e=['<h4 class="modal-title" style="white-space: nowrap"><strong>',a(this).data("title"),"</strong></h4>"].join("");var b=['<div class="modal-header">',e,"</div>"].join("");var i=['<div class="help-block ratingModalInstruct"/>'];var g=['<input type="number" data-max="5" data-min="1" value="0" data-readonly="false" data-empty-value="0" class="ratingModalInput"/>'];var l=['<div class="modal-body style="font-size:2em; white-space:nowrap;">',i,g,"</div>"].join("");var c=[' <button type="button" class="btn btn-default" data-dismiss="modal">',a(this).data("close.button.label"),"</button>"].join("");var j=['<button type="button" class="btn btn-primary ratingModalSaveButton disabled">',a(this).data("save.button.label"),"</button>"].join("");var h=['<div class="modal-footer">',c,j,"</div>"].join("");var f=['<div class="modal-content" style="display:inline-block">',b,l,h,"</div>"].join("");var d=['<div class="modal-dialog ratePortletModal-dialog{@ID}" style="text-align:center; position:static">',f,"</div>"].join("");a(this).append(d);a(this).modal("hide");a(this).find(".ratingModalSaveButton").click(function(o){var m=a(k).find("input").val();var n=a(k).data("saveurl");a.ajax({url:n,data:{rating:m},type:"POST",success:function(){a(k).modal("hide");up.notify(a(k).data("rating.save.successful"),"TopCenter","success");setTimeout(function(){a(k).find(".ratingModalInstruct").text(a(k).data("rating.instructions.rated"));},1000);},error:function(){a(k).modal("hide");up.notify(a(k).data("rating.save.unsuccessful"),"TopCenter","error");}});});a(this).on("show.bs.modal",function(o){a(k).find(".ratingModalSaveButton").addClass("disabled");var m=a(k).data("geturl");a.ajax({url:m,type:"GET",cache:false,dataType:"json",contentType:"application/json; charset=utf-8",success:function(q){if(q.rating===null){a(k).find("input").val(0);a(k).find("input").redraw(0);a(k).find(".ratingModalInstruct").text(a(k).data("rating.instructions.unrated"));}else{a(k).find(".ratingModalSaveButton").removeClass("disabled");a(k).find("input").val(q.rating);a(k).find("input").redraw(q.rating);a(k).find(".ratingModalInstruct").text(a(k).data("rating.instructions.rated"));}},error:function(q){up.notify(a(k).data("get.rating.unsucessful"),"TopCenter","error");}});var n=a(k).find(".modal-dialog").outerHeight();var p=a(window).outerHeight();a(k).find(".modal-dialog").css("transform","translate(0, 50%)");a(k).find(".modal-dialog").css("-ms-transform","translate(0, 50%)");a(k).find(".modal-dialog").css("-webkit-transform","translate(0, 50%)");a(k).find("input").change(function(){a(k).find(".ratingModalSaveButton").removeClass("disabled");});});};})(jQuery);
var up=up||{};(function(b){up.addToFavorite=function a(g){var f=g.data.portletId;var e=g.data.context;return b.ajax({url:e+"/api/layout?action=addFavorite&channelId="+f,type:"POST",data:null,dataType:"json",async:true,success:function(h,i){b("#up-notification").noty({text:h.response,type:"success"});},error:function(i,j,h){b("#up-notification").noty({text:i.response,type:"error"});}});};up.removeFromFavorite=function d(g){var f=g.data.portletId;var e=g.data.context;return b.ajax({url:e+"/api/layout?action=removeFavorite&channelId="+f,type:"POST",data:null,dataType:"json",async:true,success:function(h,i){b("#up-notification").noty({text:h.response,type:"success"});},error:function(i,j,h){b("#up-notification").noty({text:i.response,type:"error"});}});};up.moveStuff=function c(l,j,f){var e=function(p,n,m){var o=f+"/api/layout?action=movePortletAjax&sourceId="+p+"&previousNodeId="+n+"&nextNodeId="+m;console.log(o);b.ajax({url:o,type:"POST",data:null,dataType:"json",async:true,success:function(){console.log("layout move successful.");},error:function(r,s,q){console.error("Error persisting move "+o);}});};var h=function(q,o,n){var r=""===n?"appendAfter":"insertBefore";var m=""===n?o:n;var p=f+"/api/layout?action=moveTab&sourceID="+q+"&method="+r+"&elementID="+m;console.log(p);b.ajax({url:p,type:"POST",data:null,dataType:"json",async:true,success:function(){console.log("favorite group move successful.");},error:function(t,u,s){console.error("Error persisting favorite group reorder "+p);}});};var i=b(j).attr("sourceid");var g=b(j).next().length!=0?b(j).next().attr("sourceid"):"";var k=b(j).prev().length!=0?b(j).prev().attr("sourceid"):"";if("Tab"===l){h(i,k,g);}else{e(i,k,g);}};})(jQuery);
var up=up||{};up.lightboxConfig=up.lightboxConfig||(function(d,e){var f,a,c,b;b=function(g){var l,j,k,h,i;j=/\/p\/([^\/]+)\//.exec(d.location.pathname);if(j&&j[1]){k=j[1];}j=/\/p\/([^\/]+)\//.exec(g);if(j&&j[1]){h=j[1];}i="normal";if(k&&h===k){j=/\/(normal|maximized|exclusive|detached)\/render.uP/.exec(d.location.pathname);if(j&&j[1]){i=j[1];}}l=g.replace("/exclusive/","/"+i+"/");return l;};c=function(g,i){var h=e("<div/>").html(i);e(h).find("form").each(function(j,l){var m,k;k=e(l);m=b(k.attr("action"));k.attr("action",m);});e(h).find("a").each(function(j,k){var l,m;m=e(k);l=b(m.attr("href"));m.attr("href",l);return l;});e(g.selectors.content).empty().append(h);};a={selectors:{editLinks:"[data-lightbox-url]",lightbox:"#config-lightbox",title:"#config-lightbox .modal-title",loading:"#config-lightbox .loading",content:"#config-lightbox .modal-body-content"},lightboxOptions:{backdrop:"static",show:true}};f=function(i){var h,g,j,k;h=e.extend(true,a,i);e(h.selectors.editLinks).click(function(l){var m,o,n;l.preventDefault();l.stopPropagation();m=e(l.currentTarget).data("lightboxUrl");o=e(l.currentTarget).data("lightboxTitle");g=function(p){c(h,p);e(h.selectors.loading).fadeOut();e(h.selectors.content).fadeIn();};j=function(){d.location.href=e(l.currentTarget).attr("href");};if(o){e(h.selectors.title).text(o);}e(h.selectors.content).hide();e(h.selectors.loading).show();e(h.selectors.lightbox).modal(h.lightboxOptions);n=e.ajax({url:m,contentType:"text/html"});n.then(g,j);return false;});};return{init:f};}(window,jQuery));